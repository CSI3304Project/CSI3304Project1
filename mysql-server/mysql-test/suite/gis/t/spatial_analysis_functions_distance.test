##################################################################################
#                                                                                #
# This test is aimed to focus on Spatial Analysis Functions.                     #
#                                                                                #
# Distance/ST_Distance() functions take 2 geometries as inpout parameters and    #
# returns minimum distance between them.                                         #
#                                                                                #
# Creation Date: 2013-06-09                                                      #
# Author : Pavan Naik                                                            #
#                                                                                #
##################################################################################

--source include/force_myisam_default.inc
--source include/have_debug.inc
--source include/not_embedded.inc
--source include/have_geometry.inc

# Turn on the geometry data print.
--echo #Turn on the geometry data print.
SET SESSION debug="+d,row_print_geometry_data";

#Confirming the storage engine
--echo #Confirming the storage engine
SHOW VARIABLES LIKE '%engine%';

############################################################################################
# Creating the spatial objects                                                             #
############################################################################################

--echo #Creating the spatial Geometry object
USE test;

--disable_warnings
DROP TABLE IF EXISTS gis_geometrycollection;
--enable_warnings

CREATE TABLE gis_geometrycollection (fid INTEGER NOT NULL PRIMARY KEY, g GEOMETRYCOLLECTION);

############################################################################################
# Inserting the values specific to the spatial objects                                     #
############################################################################################

# Geometric elements constructing a star and some of its elememts as base
SET @star_elem_vertical= 'POLYGON((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal= 'POLYGON((25 0,0 15,30 15,22 10,25 0))';
SET @star_center= 'POINT(15 10)';
SET @star_top= 'POINT(15 25)';
SET @star_bottom_left= 'POINT(5 0)';
SET @star_bottom_right= 'POINT(25 0)';
SET @star_bottom_points= 'MULTIPOINT(5 0,25 0)';
SET @star_all_points= 'MULTIPOINT(5 0,25 0,15 10,15 25)';
SET @star_line_horizontal= 'LINESTRING(10 15,20 15)';
SET @star_line_vertical= 'LINESTRING(15 5,15 25)';
SET @star_top_to_center= 'LINESTRING(15 25,15 10)';
SET @star_lines_near_horizontal= 'MULTILINESTRING((25 0,0 15,15 30,0 5))';
SET @star_lines_near_vertical= 'MULTILINESTRING((0 5,15 25,0 25))';
SET @star= 'POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0))';
SET @star_elem_vertical_val= '((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal_val= '((25 0,0 15,30 15,22 10,25 0))';
SET @star_of_elems='MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0)))';
SET @star_collection_elems='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';
SET @star_collection_multilinestr='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),MULTILINESTRING((25 0,0 15,15 30,0 5)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';

# Star identical to the base star 
SET @star_elem_vertical_1= 'POLYGON((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal_1= 'POLYGON((25 0,0 15,30 15,22 10,25 0))';
SET @star_center_1= 'POINT(15 10)';
SET @star_top_1= 'POINT(15 25)';
SET @star_bottom_left_1= 'POINT(5 0)';
SET @star_bottom_right_1= 'POINT(25 0)';
SET @star_bottom_points_1= 'MULTIPOINT(5 0,25 0)';
SET @star_all_points_1= 'MULTIPOINT(5 0,25 0,15 10,15 25)';
SET @star_line_horizontal_1= 'LINESTRING(10 15,20 15)';
SET @star_line_vertical_1= 'LINESTRING(15 5,15 25)';
SET @star_top_to_center_1= 'LINESTRING(15 25,15 10)';
SET @star_lines_near_horizontal_1= 'MULTILINESTRING((25 0,0 15,15 30,0 5))';
SET @star_lines_near_vertical_1= 'MULTILINESTRING((0 5,15 25,0 25))';
SET @star_1= 'POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0))';
SET @star_elem_vertical_val_1= '((5 0,15 25,25 0,15 5,5 0))';
SET @star_elem_horizontal_val_1= '((25 0,0 15,30 15,22 10,25 0))';
SET @star_of_elems_1='MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0)))';
SET @star_collection_elems_1='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';

# Star like the base star, but shifted to right by 10 on X to overlap base star
SET @star_elem_vertical_2= 'POLYGON((15 0,25 25,35 0,25 5,15 0))';
SET @star_elem_horizontal_2= 'POLYGON((35 0,10 15,40 15,32 10,35 0))';
SET @star_center_2= 'POINT(25 10)';
SET @star_top_2= 'POINT(25 25)';
SET @star_bottom_left_2= 'POINT(15 0)';
SET @star_bottom_right_2= 'POINT(35 0)';
SET @star_bottom_points_2= 'MULTIPOINT(15 0,35 0)';
SET @star_all_points_2= 'MULTIPOINT(15 0,35 0,35 10,25 25)';
SET @star_line_horizontal_2= 'LINESTRING(20 15,30 15)';
SET @star_line_vertical_2= 'LINESTRING(25 5,25 25)';
SET @star_top_to_center_2= 'LINESTRING(25 25,25 10)';
SET @star_lines_near_horizontal_2= 'MULTILINESTRING((35 0,10 15,25 30,10 5))';
SET @star_lines_near_vertical_2= 'MULTILINESTRING((10 5,25 25,10 25))';
SET @star_2= 'POLYGON((15 0,17 10,10 15,20 15,25 25,30 15,40 15,32 10,35 0,25 5,15 0))';
SET @star_elem_vertical_val_2= '((15 0,25 25,35 0,25 5,15 0))';
SET @star_elem_horizontal_val_2= '((35 0,10 15,40 15,32 10,35 0))';
SET @star_of_elems_2='MULTIPOLYGON(((15 0,25 25,35 0,25 5,15 0)),((35 0,10 15,40 15,32 10,35 0)))';
SET @star_collection_elems_2='GEOMETRYCOLLECTION(MULTIPOLYGON(((15 0,25 25,35 0,25 5,15 0)),((35 0,10 15,40 15,32 10,35 0))),POLYGON((15 0,17 10,10 15,20 15,25 25,30 15,40 15,32 10,35 0,25 5,15 0)),LINESTRING(25 25,25 10),MULTIPOINT(15 0,35 0),POINT(25 25))';

# Star like the base star, but shifted to right by 60 on X to be completly separate
SET @star_elem_vertical_3= 'POLYGON((65 0,75 25,85 0,75 5,65 0))';
SET @star_elem_horizontal_3= 'POLYGON((85 0,60 15,90 15,82 10,85 0))';
SET @star_center_3= 'POINT(75 10)';
SET @star_top_3= 'POINT(75 25)';
SET @star_bottom_left_3= 'POINT(65 0)';
SET @star_bottom_right_3= 'POINT(85 0)';
SET @star_bottom_points_3= 'MULTIPOINT(65 0,85 0)';
SET @star_all_points_3= 'MULTIPOINT(65 0,85 0,75 10,75 25)';
SET @star_line_horizontal_3= 'LINESTRING(70 15,80 15)';
SET @star_line_vertical_3= 'LINESTRING(75 5,75 25)';
SET @star_top_to_center_3= 'LINESTRING(75 25,75 10)';
SET @star_lines_near_horizontal_3= 'MULTILINESTRING((85 0,60 15,85 30,60 5))';
SET @star_lines_near_vertical_3= 'MULTILINESTRING((60 5,75 25,60 25))';
SET @star_3= 'POLYGON((65 0,67 10,60 15,70 15,75 25,80 15,90 15,82 10,85 0,75 5,65 0))';
SET @star_elem_vertical_val_3= '((65 0,75 25,85 0,75 5,65 0))';
SET @star_elem_horizontal_val_3= '((85 0,60 15,90 15,82 10,85 0))';
SET @star_of_elems_3='MULTIPOLYGON(((65 0,75 25,85 0,75 5,65 0)),((85 0,60 15,90 15,82 10,85 0)))';
SET @star_collection_elems_3='GEOMETRYCOLLECTION(MULTIPOLYGON(((65 0,75 25,85 0,75 5,65 0)),((85 0,60 15,90 15,82 10,85 0))),POLYGON((65 0,67 10,60 15,70 15,75 25,80 15,90 15,82 10,85 0,75 5,65 0)),LINESTRING(75 25,75 10),MULTIPOINT(65 0,85 0),POINT(75 25))';

--echo #INSERT base star
--disable_warnings
INSERT INTO gis_geometrycollection VALUES
 (100,GeomFromText(@star)),
 (101,GeomFromText(@star_elem_vertical)),
 (102,GeomFromText(@star_elem_horizontal)),
 (103,GeomFromText(@star_of_elems)),
 (104,GeomFromText(@star_top)),
 (105,GeomFromText(@star_center)),
 (106,GeomFromText(@star_bottom_left)),
 (107,GeomFromText(@star_bottom_right)),
 (108,GeomFromText(@star_bottom_points)),
 (109,GeomFromText(@star_all_points)),
 (110,GeomFromText(@star_line_horizontal)),
 (111,GeomFromText(@star_line_vertical)),
 (112,GeomFromText(@star_top_to_center)),
 (113,GeomFromText(@star_lines_near_horizontal)),
 (114,GeomFromText(@star_lines_near_vertical)),
 (115,GeomFromText(@star_collection_elems));
--enable_warnings

--echo #INSERT identical (to base) star
--disable_warnings
INSERT INTO gis_geometrycollection VALUES
 (200,GeomFromText(@star_1)),
 (201,GeomFromText(@star_elem_vertical_1)),
 (202,GeomFromText(@star_elem_horizontal_1)),
 (203,GeomFromText(@star_of_elems_1)),
 (204,GeomFromText(@star_top_1)),
 (205,GeomFromText(@star_center_1)),
 (206,GeomFromText(@star_bottom_left_1)),
 (207,GeomFromText(@star_bottom_right_1)),
 (208,GeomFromText(@star_bottom_points_1)),
 (209,GeomFromText(@star_all_points_1)),
 (210,GeomFromText(@star_line_horizontal_1)),
 (211,GeomFromText(@star_line_vertical_1)),
 (212,GeomFromText(@star_top_to_center_1)),
 (213,GeomFromText(@star_lines_near_horizontal_1)),
 (214,GeomFromText(@star_lines_near_vertical_1)),
 (215,GeomFromText(@star_collection_elems_1));
--enable_warnings

--echo #INSERT overlapping star
--disable_warnings
INSERT INTO gis_geometrycollection VALUES
 (300,GeomFromText(@star_2)),
 (301,GeomFromText(@star_elem_vertical_2)),
 (302,GeomFromText(@star_elem_horizontal_2)),
 (303,GeomFromText(@star_of_elems_2)),
 (304,GeomFromText(@star_top_2)),
 (305,GeomFromText(@star_center_2)),
 (306,GeomFromText(@star_bottom_left_2)),
 (307,GeomFromText(@star_bottom_right_2)),
 (308,GeomFromText(@star_bottom_points_2)),
 (309,GeomFromText(@star_all_points_2)),
 (310,GeomFromText(@star_line_horizontal_2)),
 (311,GeomFromText(@star_line_vertical_2)),
 (312,GeomFromText(@star_top_to_center_2)),
 (313,GeomFromText(@star_lines_near_horizontal_2)),
 (314,GeomFromText(@star_lines_near_vertical_2)),
 (315,GeomFromText(@star_collection_elems_2));
--enable_warnings

--echo #INSERT seperate star
--disable_warnings
INSERT INTO gis_geometrycollection VALUES
 (400,GeomFromText(@star_3)),
 (401,GeomFromText(@star_elem_vertical_3)),
 (402,GeomFromText(@star_elem_horizontal_3)),
 (403,GeomFromText(@star_of_elems_3)),
 (404,GeomFromText(@star_top_3)),
 (405,GeomFromText(@star_center_3)),
 (406,GeomFromText(@star_bottom_left_3)),
 (407,GeomFromText(@star_bottom_right_3)),
 (408,GeomFromText(@star_bottom_points_3)),
 (409,GeomFromText(@star_all_points_3)),
 (410,GeomFromText(@star_line_horizontal_3)),
 (411,GeomFromText(@star_line_vertical_3)),
 (412,GeomFromText(@star_top_to_center_3)),
 (413,GeomFromText(@star_lines_near_horizontal_3)),
 (414,GeomFromText(@star_lines_near_vertical_3)),
 (415,GeomFromText(@star_collection_elems_3));
--enable_warnings

--disable_warnings
DROP TABLE IF EXISTS gis_geometrycollection_2;
--enable_warnings
CREATE TABLE gis_geometrycollection_2 SELECT fid as fid2,g as g2 FROM gis_geometrycollection;

--echo #Checking the integrity of the above create/insert statements 

--echo #64 rows. 
SELECT count(astext(g) != 'NULL') FROM gis_geometrycollection;
--echo #64 rows. 
SELECT count(astext(g2) != 'NULL') FROM gis_geometrycollection_2;

############################################################################################
# Checking the spatial analysis functions                                                  #
############################################################################################

--echo #=======================================================================================
--echo # Distance(g1,g2)
--echo #=======================================================================================

--echo #-------------------------------------------------------------------------------------------
--echo # point,point
SELECT Distance(GeomFromText(@star_center),GeomFromText(@star_center));

SELECT Distance(GeomFromText(@star_top),GeomFromText(@star_center));

SELECT Distance(GeomFromText('POINT(0 0)'),GeomFromText('POINT(-0 0.00)'));

SELECT Distance(GeomFromText('POINT(0 0)'),GeomFromText('POINT(1e154 0)'));

SELECT Distance(GeomFromText('POINT(0 0)'),GeomFromText('POINT(-1e154 0)'));

SELECT Distance(g,GeomFromText(@star_center)) FROM gis_geometrycollection WHERE fid=105;

--echo #-------------------------------------------------------------------------------------------
--echo # point,multipoint
SELECT Distance(GeomFromText(@star_bottom_left),GeomFromText(@star_bottom_points));

SELECT Distance(GeomFromText('POINT(0 0)'),GeomFromText('MULTIPOINT(10 10)'));

SELECT Distance(GeomFromText('POINT(1e154 0)'),GeomFromText('MULTIPOINT(1e154 10)'));

SELECT Distance(GeomFromText('POINT(0 0)'),GeomFromText('MULTIPOINT(-0 0.000,-0.000 0)'));

SELECT Distance(g,GeomFromText(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=106;

--echo #-------------------------------------------------------------------------------------------
--echo # point,linestring
SELECT Distance(GeomFromText(@star_top),GeomFromText(@star_top_to_center));

SELECT Distance(GeomFromText('POINT(0 0)'),GeomFromText('LINESTRING(10 10,10 0)'));

SELECT Distance(GeomFromText('POINT(0 0)'),GeomFromText('LINESTRING(10 10,10 0,0.0000 -0.0000)'));

SELECT Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # point,multilinestring
SELECT Distance(GeomFromText(@star_top),GeomFromText(@star_lines_near_vertical));

SELECT Distance(GeomFromText('POINT(0 0)'),GeomFromText('MULTILINESTRING((10 10,1 0))'));

SELECT Distance(GeomFromText('POINT(0 0)'),GeomFromText('MULTILINESTRING((10 10,10 0),(0.0000 -0.0000))'));

SELECT Distance(GeomFromText('POINT(1e77 0)'),GeomFromText('MULTILINESTRING((0 0,0 1e154),(0 1e154,1e154 0))'));

SELECT Distance(g,GeomFromText(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # point,polygon
SELECT Distance(GeomFromText(@star_top),GeomFromText(@star));

SELECT Distance(GeomFromText('POINT(5 5)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT Distance(GeomFromText('POINT(5 5)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4))'));

SELECT Distance(GeomFromText('POINT(20 20)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT Distance(g,GeomFromText(@star)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # point,multipolygon
SELECT Distance(GeomFromText(@star_top),GeomFromText(@star_of_elems));

SELECT Distance(GeomFromText('POINT(1 1)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)))'));

SELECT Distance(GeomFromText('POINT(15 15)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)))'));

SELECT Distance(GeomFromText('POINT(4 4)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('POINT(5 5)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0)),((3 3,3 7,7 7,7 3),(4 4,4 6,6 6,6 4)))'));

SELECT Distance(GeomFromText('POINT(5 5)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # point,geometrycollection
SELECT Distance(GeomFromText(@star_top),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText('POINT(5 5)'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(5 5)))'));

SELECT Distance(GeomFromText('POINT(5 5)'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4,5 5),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('POINT(5 5)'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,point
SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_top));

SELECT Distance(GeomFromText(@star_bottom_points),GeomFromText(@star_center));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,10 0)'),GeomFromText('POINT(5 0)'));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,10 0)'),GeomFromText('POINT(5 5)'));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,10 0)'),GeomFromText('POINT(10 5)'));

SELECT Distance(GeomFromText('MULTIPOINT(1e154 0)'),GeomFromText('POINT(1e154 0)'));

SELECT Distance(g,GeomFromText(@star_bottom_left)) FROM gis_geometrycollection WHERE fid=108;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,multipoint
SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_bottom_points));

SELECT Distance(GeomFromText(@star_bottom_points),GeomFromText(@star_all_points));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,5 0,10 0)'),GeomFromText('MULTIPOINT(10 0.0001)'));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,5 0,10 0)'),GeomFromText('MULTIPOINT(2.5 0.0001)'));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,5 0,10 0)'),GeomFromText('MULTIPOINT(0 -1e154)'));

SELECT Distance(g,GeomFromText(@star_all_points)) FROM gis_geometrycollection WHERE fid=108;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,linestring
SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_top_to_center));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,5 0)'),GeomFromText('LINESTRING(2 2,5 0,8 2)'));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,5 0,10 0)'),GeomFromText('LINESTRING(2 2,8 2)'));

SELECT Distance(GeomFromText('MULTIPOINT(1 1,1 4,4 4,4 0.00009)'),GeomFromText('LINESTRING(0 0,0 5,5 5,5 0,0 0)'));

SELECT Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,multilinestring
SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_lines_near_vertical));

SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_lines_near_horizontal));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,5 0)'),GeomFromText('MULTILINESTRING((2 2,5 0),(1 1,10 10))'));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,5 0)'),GeomFromText('MULTILINESTRING((2 2,2 10,10 10),(10 10,10 2,2 2))'));

SELECT Distance(GeomFromText('MULTIPOINT(4 4,6 6)'),GeomFromText('MULTILINESTRING((0 0,0 10,10 10,10 0,0 0))'));

SELECT Distance(g,GeomFromText(@star_lines_near_horizontal)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,polygon
SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_elem_vertical));

SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_elem_horizontal));

SELECT Distance(GeomFromText('MULTIPOINT(4 4,11 11)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT Distance(GeomFromText('MULTIPOINT(0 -2,11 11)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT Distance(GeomFromText('MULTIPOINT(5.5 5.5)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT Distance(GeomFromText('MULTIPOINT(4 4,6 6)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT Distance(g,GeomFromText(@star_elem_horizontal)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,multipolygon
SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_of_elems));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,0 30,30 25)'),GeomFromText(@star_of_elems));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,0 5)'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT Distance(GeomFromText('MULTIPOINT(4.5 4.5,5.5 5.5)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('MULTIPOINT(5 5,15 15.1)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'));

SELECT Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,geometrycollection
SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText(@star_all_points),GeomFromText(@star_collection_multilinestr));

SELECT Distance(GeomFromText('MULTIPOINT(0 0,0 30,30 25)'),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText('MULTIPOINT(5 5,10 10)'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(5 5)))'));

SELECT Distance(GeomFromText('MULTIPOINT(5 5,20 20)'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4,5 5),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('MULTIPOINT(5 5,20 20)'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,point
SELECT Distance(GeomFromText(@star_top_to_center),GeomFromText(@star_center));

SELECT Distance(GeomFromText(@star_top_to_center),GeomFromText(@star_bottom_left));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 0)'),GeomFromText('POINT(5 0)'));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 0)'),GeomFromText('POINT(10 0.00000001)'));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 0)'),GeomFromText('POINT(5 1000000)'));

SELECT Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=110 and fid2=105;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,multipoint
SELECT Distance(GeomFromText(@star_line_vertical),GeomFromText(@star_all_points));

SELECT Distance(GeomFromText(@star_line_vertical),GeomFromText('MULTIPOINT(15 10,15 25)'));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 0,10 10,0 10)'),GeomFromText('MULTIPOINT(5 0,10 5,5 10)'));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 0,10 10,0 10)'),GeomFromText('MULTIPOINT(10.2 0,10 10.4)'));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 0,10 10,0 10)'),GeomFromText('MULTIPOINT(4 4,5 5,7 7)'));

SELECT Distance(g,GeomFromText('MULTIPOINT(15 10,15 25)')) FROM gis_geometrycollection WHERE fid=111;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,linestring
SELECT Distance(GeomFromText(@star_line_vertical),GeomFromText(@star_top_to_center));

SELECT Distance(GeomFromText(@star_top_to_center),GeomFromText(@star_line_vertical));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('LINESTRING(0 10,10 0)'));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('LINESTRING(0 10,10 19)'));

SELECT Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=111;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,multilinestring
SELECT Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_lines_near_horizontal));

SELECT Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_lines_near_vertical));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('MULTILINESTRING((0 10,5 5.5),(5 4.6,10 0))'));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('MULTILINESTRING((0 10,10 19),(10 0,10 10))'));

SELECT Distance(g,GeomFromText(@star_lines_near_horizontal)) FROM gis_geometrycollection WHERE fid=110;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,polygon
SELECT Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_elem_horizontal));

SELECT Distance(GeomFromText(@star_line_horizontal),GeomFromText('POLYGON((11 15,19 15,19 10))'));

SELECT Distance(GeomFromText('LINESTRING(4 4,6 6)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT Distance(GeomFromText('LINESTRING(4 4,6 6)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT Distance(GeomFromText('LINESTRING(-11 -11,-11 11)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT Distance(GeomFromText('LINESTRING(4.5 4.5,5.5 5.4)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,multipolygon
SELECT Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_of_elems));

SELECT Distance(GeomFromText(@star_line_horizontal),GeomFromText('MULTIPOLYGON(((11 15,19 15,19 10)),((25 0,0 15,25 10)))'));

SELECT Distance(GeomFromText('LINESTRING(0 0,20 20,30 30)'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT Distance(GeomFromText('LINESTRING(-1 5)'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT Distance(GeomFromText('LINESTRING(4.5 4.5,5.5 5.5)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('LINESTRING(5 5,15 15)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'));

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,geometrycollection
SELECT Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_collection_elems_3));

SELECT Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_collection_multilinestr));

SELECT Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(0 5)))'));

SELECT Distance(GeomFromText('LINESTRING(4.5 4.5,5.5 5.5)'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('LINESTRING(5 5,15 15,25 24)'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(g,GeomFromText(@star_collection_elems_3)) FROM gis_geometrycollection WHERE fid=110;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,point
SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_top));

SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_center));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('POINT(5 0)'));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('POINT(5 5)'));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('POINT(5 1000000)'));

SELECT Distance(g,GeomFromText(@star_top)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,multipoint
SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_bottom_points));

SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_all_points));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('MULTIPOINT(5 0,10 5,5 10)'));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('MULTIPOINT(10.41 0,10 10.4)'));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('MULTIPOINT(4 4,5 5,6.5 6.5)'));

SELECT Distance(g,GeomFromText(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=114;

SELECT Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=114 and fid2=108;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,linestring
SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_line_vertical));

SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_line_horizontal));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('LINESTRING(0 5,10 5)'));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('LINESTRING(0 10,10 19)'));

SELECT Distance(g,GeomFromText(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,multilinestring
SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_lines_near_horizontal));

SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText('MULTILINESTRING((0 5,15 25,0 15))'));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('MULTILINESTRING((0 5,14.5 5,14 15,0 15))'));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('MULTILINESTRING((0 0,0 10,10 0,10 10))'));

SELECT Distance(g,GeomFromText('MULTILINESTRING((0 5,15 25,0 15))')) FROM gis_geometrycollection WHERE fid=114;

SELECT Distance(g,GeomFromText(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,polygon
SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_elem_vertical));

SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_elem_horizontal));

SELECT Distance(GeomFromText('MULTILINESTRING((4 4,6 6))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT Distance(GeomFromText('MULTILINESTRING((4 4,6 6))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT Distance(GeomFromText('MULTILINESTRING((-11 -11,-11 11))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT Distance(GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.4))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT Distance(GeomFromText('MULTILINESTRING((14 14,14 16),(10 15,10 20,20 20))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'));

SELECT Distance(g,GeomFromText(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,multipolygon
SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_of_elems));

SELECT Distance(GeomFromText('MULTILINESTRING((0 25,25 0,25 30))'),GeomFromText(@star_elem_vertical));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,20 20,30 30))'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT Distance(GeomFromText('MULTILINESTRING((10 10,20 20),(30 30))'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT Distance(GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5))'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5),(14.5 14.5,15.4 15.6))'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'));

SELECT Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,geometrycollection
SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_collection_multilinestr));

SELECT Distance(GeomFromText('MULTILINESTRING((0 25,25 0,25 30))'),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText('MULTILINESTRING((0 0,10 10))'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(0 5)))'));

SELECT Distance(GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5))'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('MULTILINESTRING((5 5,15 15,25 25))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,point
SELECT Distance(GeomFromText(@star),GeomFromText(@star_center));

SELECT Distance(GeomFromText(@star_elem_vertical),GeomFromText('POINT(0 0)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('POINT(5 0)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('POINT(20 20)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('POINT(5 5)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('POINT(6 6)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('POINT(15 15)'));

SELECT Distance(g,GeomFromText(@star_center)) FROM gis_geometrycollection WHERE fid=100;
--echo #-------------------------------------------------------------------------------------------
--echo # polygon,multipoint
SELECT Distance(GeomFromText(@star),GeomFromText(@star_all_points));

SELECT Distance(GeomFromText(@star_elem_vertical),GeomFromText('MULTIPOINT(0 0,30 25)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTIPOINT(5 0,20 20)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTIPOINT(20 20,-9 -9)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTIPOINT(4.5 4.5,5.5 5.5)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTIPOINT(4 4,6 6,8 8,15 15)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('MULTIPOINT(15 15)'));

SELECT Distance(g,GeomFromText(@star_all_points)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,linestring
SELECT Distance(GeomFromText(@star),GeomFromText(@star_line_vertical));

SELECT Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star_line_horizontal));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('LINESTRING(5 0,20 20,100 100)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('LINESTRING(110 110,-100 50)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('LINESTRING(4.3 4.3,5.5 5.5)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('LINESTRING(4 4,6 6,8 8,15 15)'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('LINESTRING(11 11,14 14,15 15,16 16,20 20)'));

SELECT Distance(g,GeomFromText(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=100;

SELECT Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=100 and fid2=111;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,multilinestring
SELECT Distance(GeomFromText(@star),GeomFromText(@star_lines_near_vertical));

SELECT Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star_lines_near_horizontal));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTILINESTRING((5 0,20 20),(100 100))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTILINESTRING((110 110,-100 100),(-50 50))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTILINESTRING((4.3 4.3,5.5 5.5))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTILINESTRING((0 0,2 2,4 4,6 6),(8 8,10 10,15 15))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('MULTILINESTRING((11 11,14 14),(15 15,16 16,20 20))'));

SELECT Distance(g,GeomFromText(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,polygon
SELECT Distance(GeomFromText(@star),GeomFromText(@star_elem_vertical));

SELECT Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('POLYGON((5 0,20 20,100 100))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('POLYGON((110 110,-100 100,-50 50))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('POLYGON((4.3 4.3,4.5 4.8,5 5.5))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('POLYGON((4 4,6 6,8 8,10 15))'));

SELECT Distance(g,GeomFromText(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,multipolygon
SELECT Distance(GeomFromText(@star),GeomFromText(@star_of_elems));

SELECT Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star_of_elems));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTIPOLYGON(((110 110,-100 100,-50 50)))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTIPOLYGON(((5 0,20 20,100 100)),((0 0,-10 -10,10 100)))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTIPOLYGON(((4.3 4.3,4.7 5,5 5.6)))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTIPOLYGON(((4 4,6 6,8 8,10 15)))'));

SELECT Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,geometrycollection
SELECT Distance(GeomFromText(@star),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText(@star),GeomFromText(@star_collection_multilinestr));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 15)))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,point
SELECT Distance(GeomFromText(@star_of_elems),GeomFromText(@star_top));

SELECT Distance(GeomFromText(@star_of_elems),GeomFromText('POINT(30 30)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('POINT(0 8)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('POINT(20 20)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('POINT(5 5)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('POINT(15 15)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('POINT(16.1 16.1)'));

SELECT Distance(g,GeomFromText(@star_top)) FROM gis_geometrycollection WHERE fid=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,multipoint
SELECT Distance(GeomFromText(@star_of_elems),GeomFromText(@star_bottom_points));

SELECT Distance(GeomFromText(@star_of_elems),GeomFromText('MULTIPOINT(30 30,0 35)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTIPOINT(0 8,100 100)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTIPOINT(50 50,-30 50)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTIPOINT(4.5 4.5,5.5 5.5)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTIPOINT(15.9 15.9)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTIPOINT(19 19,100 100)'));

SELECT Distance(g,GeomFromText(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,linestring
SELECT Distance(GeomFromText(@star_of_elems),GeomFromText(@star_top_to_center));

SELECT Distance(GeomFromText(@star_of_elems),GeomFromText('LINESTRING(30 30,0 35)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('LINESTRING(0 8,100 100)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('LINESTRING(50 50,-30 50)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('LINESTRING(4.5 4.5,5.5 5.5)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('LINESTRING(14.5 14.5,15.5 15.5)'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('LINESTRING(19 19,100 100)'));

SELECT Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,multilinestring
SELECT Distance(GeomFromText(@star_of_elems),GeomFromText(@star_lines_near_vertical));

SELECT Distance(GeomFromText(@star_of_elems),GeomFromText('MULTILINESTRING((0 30,30 30,0 35))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTILINESTRING((0 8,10 10,20 20),(50 50,75 75,100 100))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTILINESTRING((50 50,100 50),(-50 50,-40 50))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTILINESTRING((14.5 14.5,15.5 15.5))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTILINESTRING((-10 -10,50 50,100 100))'));

SELECT Distance(g,GeomFromText(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,multipolygon
SELECT Distance(GeomFromText(@star_of_elems),GeomFromText(@star_of_elems));

SELECT Distance(GeomFromText(@star_of_elems),GeomFromText('MULTIPOLYGON(((0 0,15 25,35 0,0 0),(5 0,15 25,25 0,15 5,5 0)))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTIPOLYGON(((10 10,10 -10,-10 -10,-10 10,10 10)))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTIPOLYGON(((20 20,20 30,30 30,30 20,20 20)))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTIPOLYGON(((4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTIPOLYGON(((14.5 14.5,14.5 15.5,15.5 15.5)))'));

SELECT Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=103;

SELECT Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

SELECT Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,geometrycollection
SELECT Distance(GeomFromText(@star_of_elems),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText(@star_of_elems),GeomFromText(@star_collection_elems_3));

SELECT Distance(GeomFromText(@star_of_elems),GeomFromText(@star_collection_multilinestr));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 55)))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=103;

SELECT Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=215;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,point
SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_top));

SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText('POINT(30 30)'));

SELECT Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('POINT(30 30)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('POINT(0 0)'));

Select Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('POINT(100 100)'));

Select Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(),POLYGON((0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('POINT(100 100)'));

Select Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)),GEOMETRYCOLLECTION())'),GeomFromText('POINT(100 100)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('POINT(20 20)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('POINT(5 5)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('POINT(15 15)'));

SELECT Distance(g,GeomFromText(@star_top)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,multipoint
SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_bottom_points));

SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText('MULTIPOINT(30 30,0 35)'));

SELECT Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('MULTIPOINT(30 30,0 35)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('MULTIPOINT(0 0,100 100)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(LINESTRING(0 0,10 10,20 20),GEOMETRYCOLLECTION())'),ST_GeomFromText('MULTIPOINT(5 0,10 0)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('MULTIPOINT(20 20,40 40,60 60)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTIPOINT(4.5 4.5,5.5 5.5)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('MULTIPOINT(4 4,6 6,8 8)'));

SELECT Distance(g,GeomFromText(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,linestring
SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_top_to_center));

SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText('LINESTRING(30 30,0 35)'));

SELECT Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('LINESTRING(30 30,0 35)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(LINESTRING(0 0,10 10,20 20))'),ST_GeomFromText('LINESTRING(5 0,10 0)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(LINESTRING(0 0,10 10,20 20),GEOMETRYCOLLECTION())'),ST_GeomFromText('LINESTRING(5 0,10 0)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('LINESTRING(0 0,100 100)'));

Select Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('LINESTRING(0 0,10 10)'));

Select Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(),POLYGON((0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('LINESTRING(0 0,10 10)'));

Select Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)),GEOMETRYCOLLECTION())'),GeomFromText('LINESTRING(0 0,10 10)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('LINESTRING(20 20,40 40,60 60)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('LINESTRING(4.5 4.5,5.5 5.5)'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('LINESTRING(4 4,6 6,8 8)'));

SELECT Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,multilinestring
SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_lines_near_vertical));

SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText('MULTILINESTRING((0 30,30 30,0 35))'));

SELECT Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('MULTILINESTRING((0 30,30 30,0 35))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('MULTILINESTRING((0 0,100 100))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('MULTILINESTRING((20 20,40 40),(60 60))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('MULTILINESTRING((4 4,6 6),(8 8,10 10))'));

SELECT Distance(g,GeomFromText(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,polygon
SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_elem_vertical));

SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText(@star));

SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText('POLYGON((0 0,15 25,35 0,0 0))'));

SELECT Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('POLYGON((0 0,15 25,35 0,0 0))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('POLYGON((0 0,30 40,90 100))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('POLYGON((20 20,40 40,50 60))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('POLYGON((4.2 4.2,5 5,5.7 5.8))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('POLYGON((4 4,6 6,8 8,10 20))'));

SELECT Distance(g,GeomFromText(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,multipolygon
SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_of_elems));

SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText('MULTIPOLYGON(((0 0,15 25,35 0,0 0),(5 0,15 25,25 0,15 5,5 0)))'));

SELECT Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('MULTIPOLYGON(((0 0,15 25,35 0,0 0),(5 0,15 25,25 0,15 5,5 0)))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('MULTIPOLYGON(((0 0,30 40,90 100)))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('MULTIPOLYGON(((20 20,40 40,50 60)))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTIPOLYGON(((4.2 4.2,5 5,5.7 5.8)))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('MULTIPOLYGON(((4 4,6 6,8 8,10 20)))'));

SELECT Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=115;

SELECT Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=115 and fid2=103;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,geometrycollection
SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_collection_elems));

SELECT Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_collection_elems_3));

SELECT Distance(GeomFromText(@star_collection_multilinestr),GeomFromText(@star_collection_elems_3));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('GEOMETRYCOLLECTION(POINT(0 0),LINESTRING(0 0,50 0,100 0))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('GEOMETRYCOLLECTION(MULTIPOINT(4.5 4.5,5.5 5.5))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('GEOMETRYCOLLECTION(MULTILINESTRING((40 40,50 50),(5 5)))'));

SELECT Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=115;

SELECT Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=115 and fid2=215;

--echo #=======================================================================================
--echo # ST_Distance(g1,g2)
--echo #=======================================================================================

--echo #-------------------------------------------------------------------------------------------
--echo # point,point
SELECT ST_Distance(GeomFromText(@star_center),GeomFromText(@star_center));

SELECT ST_Distance(GeomFromText(@star_top),GeomFromText(@star_center));

SELECT ST_Distance(GeomFromText('POINT(0 0)'),GeomFromText('POINT(-0 0.00)'));

SELECT ST_Distance(GeomFromText('POINT(0 0)'),GeomFromText('POINT(1e154 0)'));

SELECT ST_Distance(GeomFromText('POINT(0 0)'),GeomFromText('POINT(-1e154 0)'));

SELECT ST_Distance(g,GeomFromText(@star_center)) FROM gis_geometrycollection WHERE fid=105;

--echo #-------------------------------------------------------------------------------------------
--echo # point,multipoint
SELECT ST_Distance(GeomFromText(@star_bottom_left),GeomFromText(@star_bottom_points));

SELECT ST_Distance(GeomFromText('POINT(0 0)'),GeomFromText('MULTIPOINT(10 10)'));

SELECT ST_Distance(GeomFromText('POINT(1e154 0)'),GeomFromText('MULTIPOINT(1e154 10)'));

SELECT ST_Distance(GeomFromText('POINT(0 0)'),GeomFromText('MULTIPOINT(-0 0.000,-0.000 0)'));

SELECT ST_Distance(g,GeomFromText(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=106;

--echo #-------------------------------------------------------------------------------------------
--echo # point,linestring
SELECT ST_Distance(GeomFromText(@star_top),GeomFromText(@star_top_to_center));

SELECT ST_Distance(GeomFromText('POINT(0 0)'),GeomFromText('LINESTRING(10 10,10 0)'));

SELECT ST_Distance(GeomFromText('POINT(0 0)'),GeomFromText('LINESTRING(10 10,10 0,0.0000 -0.0000)'));

SELECT ST_Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # point,multilinestring
SELECT ST_Distance(GeomFromText(@star_top),GeomFromText(@star_lines_near_vertical));

SELECT ST_Distance(GeomFromText('POINT(0 0)'),GeomFromText('MULTILINESTRING((10 10,1 0))'));

SELECT ST_Distance(GeomFromText('POINT(0 0)'),GeomFromText('MULTILINESTRING((10 10,10 0),(0.0000 -0.0000))'));

SELECT ST_Distance(GeomFromText('POINT(1e77 0)'),GeomFromText('MULTILINESTRING((0 0,0 1e154),(0 1e154,1e154 0))'));

SELECT ST_Distance(g,GeomFromText(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # point,polygon
SELECT ST_Distance(GeomFromText(@star_top),GeomFromText(@star));

SELECT ST_Distance(GeomFromText('POINT(5 5)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Distance(GeomFromText('POINT(5 5)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4))'));

SELECT ST_Distance(GeomFromText('POINT(20 20)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Distance(g,GeomFromText(@star)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # point,multipolygon
SELECT ST_Distance(GeomFromText(@star_top),GeomFromText(@star_of_elems));

SELECT ST_Distance(GeomFromText('POINT(1 1)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)))'));

SELECT ST_Distance(GeomFromText('POINT(15 15)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0)))'));

SELECT ST_Distance(GeomFromText('POINT(4 4)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('POINT(5 5)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0)),((3 3,3 7,7 7,7 3),(4 4,4 6,6 6,6 4)))'));

SELECT ST_Distance(GeomFromText('POINT(5 5)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # point,geometrycollection
SELECT ST_Distance(GeomFromText(@star_top),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText('POINT(5 5)'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(5 5)))'));

SELECT ST_Distance(GeomFromText('POINT(5 5)'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4,5 5),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('POINT(5 5)'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=104;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,point
SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_top));

SELECT ST_Distance(GeomFromText(@star_bottom_points),GeomFromText(@star_center));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,10 0)'),GeomFromText('POINT(5 0)'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,10 0)'),GeomFromText('POINT(5 5)'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,10 0)'),GeomFromText('POINT(10 5)'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(1e154 0)'),GeomFromText('POINT(1e154 0)'));

SELECT ST_Distance(g,GeomFromText(@star_bottom_left)) FROM gis_geometrycollection WHERE fid=108;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,multipoint
SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_bottom_points));

SELECT ST_Distance(GeomFromText(@star_bottom_points),GeomFromText(@star_all_points));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,5 0,10 0)'),GeomFromText('MULTIPOINT(10 0.0001)'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,5 0,10 0)'),GeomFromText('MULTIPOINT(2.5 0.0001)'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,5 0,10 0)'),GeomFromText('MULTIPOINT(0 -1e154)'));

SELECT ST_Distance(g,GeomFromText(@star_all_points)) FROM gis_geometrycollection WHERE fid=108;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,linestring
SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_top_to_center));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,5 0)'),GeomFromText('LINESTRING(2 2,5 0,8 2)'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,5 0,10 0)'),GeomFromText('LINESTRING(2 2,8 2)'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(1 1,1 4,4 4,4 0.00009)'),GeomFromText('LINESTRING(0 0,0 5,5 5,5 0,0 0)'));

SELECT ST_Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,multilinestring
SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_lines_near_vertical));

SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_lines_near_horizontal));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,5 0)'),GeomFromText('MULTILINESTRING((2 2,5 0),(1 1,10 10))'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,5 0)'),GeomFromText('MULTILINESTRING((2 2,2 10,10 10),(10 10,10 2,2 2))'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(4 4,6 6)'),GeomFromText('MULTILINESTRING((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Distance(g,GeomFromText(@star_lines_near_horizontal)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,polygon
SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_elem_vertical));

SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_elem_horizontal));

SELECT ST_Distance(GeomFromText('MULTIPOINT(4 4,11 11)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 -2,11 11)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(5.5 5.5)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(4 4,6 6)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT ST_Distance(g,GeomFromText(@star_elem_horizontal)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,multipolygon
SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_of_elems));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,0 30,30 25)'),GeomFromText(@star_of_elems));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,0 5)'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(4.5 4.5,5.5 5.5)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(5 5,15 15.1)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'));

SELECT ST_Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # multipoint,geometrycollection
SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText(@star_all_points),GeomFromText(@star_collection_multilinestr));

SELECT ST_Distance(GeomFromText('MULTIPOINT(0 0,0 30,30 25)'),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText('MULTIPOINT(5 5,10 10)'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(5 5)))'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(5 5,20 20)'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4,5 5),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('MULTIPOINT(5 5,20 20)'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=109;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,point
SELECT ST_Distance(GeomFromText(@star_top_to_center),GeomFromText(@star_center));

SELECT ST_Distance(GeomFromText(@star_top_to_center),GeomFromText(@star_bottom_left));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 0)'),GeomFromText('POINT(5 0)'));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 0)'),GeomFromText('POINT(10 0.00000001)'));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 0)'),GeomFromText('POINT(5 1000000)'));

SELECT ST_Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=110 and fid2=105;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,multipoint
SELECT ST_Distance(GeomFromText(@star_line_vertical),GeomFromText(@star_all_points));

SELECT ST_Distance(GeomFromText(@star_line_vertical),GeomFromText('MULTIPOINT(15 10,15 25)'));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 0,10 10,0 10)'),GeomFromText('MULTIPOINT(5 0,10 5,5 10)'));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 0,10 10,0 10)'),GeomFromText('MULTIPOINT(10.2 0,10 10.4)'));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 0,10 10,0 10)'),GeomFromText('MULTIPOINT(4 4,5 5,7 7)'));

SELECT ST_Distance(g,GeomFromText('MULTIPOINT(15 10,15 25)')) FROM gis_geometrycollection WHERE fid=111;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,linestring
SELECT ST_Distance(GeomFromText(@star_line_vertical),GeomFromText(@star_top_to_center));

SELECT ST_Distance(GeomFromText(@star_top_to_center),GeomFromText(@star_line_vertical));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('LINESTRING(0 10,10 0)'));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('LINESTRING(0 10,10 19)'));

SELECT ST_Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=111;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,multilinestring
SELECT ST_Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_lines_near_horizontal));

SELECT ST_Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_lines_near_vertical));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('MULTILINESTRING((0 10,5 5.5),(5 4.6,10 0))'));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('MULTILINESTRING((0 10,10 19),(10 0,10 10))'));

SELECT ST_Distance(g,GeomFromText(@star_lines_near_horizontal)) FROM gis_geometrycollection WHERE fid=110;

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,polygon
SELECT ST_Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_elem_horizontal));

SELECT ST_Distance(GeomFromText(@star_line_horizontal),GeomFromText('POLYGON((11 15,19 15,19 10))'));

SELECT ST_Distance(GeomFromText('LINESTRING(4 4,6 6)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Distance(GeomFromText('LINESTRING(4 4,6 6)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT ST_Distance(GeomFromText('LINESTRING(-11 -11,-11 11)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Distance(GeomFromText('LINESTRING(4.5 4.5,5.5 5.4)'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,multipolygon
SELECT ST_Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_of_elems));

SELECT ST_Distance(GeomFromText(@star_line_horizontal),GeomFromText('MULTIPOLYGON(((11 15,19 15,19 10)),((25 0,0 15,25 10)))'));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,20 20,30 30)'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT ST_Distance(GeomFromText('LINESTRING(-1 5)'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT ST_Distance(GeomFromText('LINESTRING(4.5 4.5,5.5 5.5)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('LINESTRING(5 5,15 15)'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'));

--echo #-------------------------------------------------------------------------------------------
--echo # linestring,geometrycollection
SELECT ST_Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_collection_elems_3));

SELECT ST_Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText(@star_line_horizontal),GeomFromText(@star_collection_multilinestr));

SELECT ST_Distance(GeomFromText('LINESTRING(0 0,10 10)'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(0 5)))'));

SELECT ST_Distance(GeomFromText('LINESTRING(4.5 4.5,5.5 5.5)'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('LINESTRING(5 5,15 15,25 24)'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(g,GeomFromText(@star_collection_elems_3)) FROM gis_geometrycollection WHERE fid=110;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,point
SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_top));

SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_center));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('POINT(5 0)'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('POINT(5 5)'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('POINT(5 1000000)'));

SELECT ST_Distance(g,GeomFromText(@star_top)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,multipoint
SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_bottom_points));

SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_all_points));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('MULTIPOINT(5 0,10 5,5 10)'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('MULTIPOINT(10.41 0,10 10.4)'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('MULTIPOINT(4 4,5 5,6.5 6.5)'));

SELECT ST_Distance(g,GeomFromText(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=114;

SELECT ST_Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=114 and fid2=108;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,linestring
SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_line_vertical));

SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_line_horizontal));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('LINESTRING(0 5,10 5)'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(10 10,0 10))'),GeomFromText('LINESTRING(0 10,10 19)'));

SELECT ST_Distance(g,GeomFromText(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,multilinestring
SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_lines_near_horizontal));

SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText('MULTILINESTRING((0 5,15 25,0 15))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('MULTILINESTRING((0 5,14.5 5,14 15,0 15))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 0),(0 10,10 10))'),GeomFromText('MULTILINESTRING((0 0,0 10,10 0,10 10))'));

SELECT ST_Distance(g,GeomFromText('MULTILINESTRING((0 5,15 25,0 15))')) FROM gis_geometrycollection WHERE fid=114;

SELECT ST_Distance(g,GeomFromText(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,polygon
SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_elem_vertical));

SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_elem_horizontal));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((4 4,6 6))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((4 4,6 6))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((-11 -11,-11 11))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.4))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((14 14,14 16),(10 15,10 20,20 20))'),GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'));

SELECT ST_Distance(g,GeomFromText(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,multipolygon
SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_of_elems));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 25,25 0,25 30))'),GeomFromText(@star_elem_vertical));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,20 20,30 30))'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((10 10,20 20),(30 30))'),GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5))'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5),(14.5 14.5,15.4 15.6))'),GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'));

SELECT ST_Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # multilinestring,geometrycollection
SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText(@star_lines_near_vertical),GeomFromText(@star_collection_multilinestr));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 25,25 0,25 30))'),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((0 0,10 10))'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(0 5)))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5))'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('MULTILINESTRING((5 5,15 15,25 25))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=114;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,point
SELECT ST_Distance(GeomFromText(@star),GeomFromText(@star_center));

SELECT ST_Distance(GeomFromText(@star_elem_vertical),GeomFromText('POINT(0 0)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('POINT(5 0)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('POINT(20 20)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('POINT(5 5)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('POINT(6 6)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('POINT(15 15)'));

SELECT ST_Distance(g,GeomFromText(@star_center)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,multipoint
SELECT ST_Distance(GeomFromText(@star),GeomFromText(@star_all_points));

SELECT ST_Distance(GeomFromText(@star_elem_vertical),GeomFromText('MULTIPOINT(0 0,30 25)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTIPOINT(5 0,20 20)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTIPOINT(20 20,-9 -9)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTIPOINT(4.5 4.5,5.5 5.5)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTIPOINT(4 4,6 6,8 8,15 15)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('MULTIPOINT(15 15)'));

SELECT ST_Distance(g,GeomFromText(@star_all_points)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,linestring
SELECT ST_Distance(GeomFromText(@star),GeomFromText(@star_line_vertical));

SELECT ST_Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star_line_horizontal));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('LINESTRING(5 0,20 20,100 100)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('LINESTRING(110 110,-100 50)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('LINESTRING(4.3 4.3,5.5 5.5)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('LINESTRING(4 4,6 6,8 8,15 15)'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('LINESTRING(11 11,14 14,15 15,16 16,20 20)'));

SELECT ST_Distance(g,GeomFromText(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=100;

SELECT ST_Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=100 and fid2=111;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,multilinestring
SELECT ST_Distance(GeomFromText(@star),GeomFromText(@star_lines_near_vertical));

SELECT ST_Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star_lines_near_horizontal));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTILINESTRING((5 0,20 20),(100 100))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTILINESTRING((110 110,-100 100),(-50 50))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTILINESTRING((4.3 4.3,5.5 5.5))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTILINESTRING((0 0,2 2,4 4,6 6),(8 8,10 10,15 15))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('MULTILINESTRING((11 11,14 14),(15 15,16 16,20 20))'));

SELECT ST_Distance(g,GeomFromText(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,polygon
SELECT ST_Distance(GeomFromText(@star),GeomFromText(@star_elem_vertical));

SELECT ST_Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('POLYGON((5 0,20 20,100 100))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('POLYGON((110 110,-100 100,-50 50))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('POLYGON((4.3 4.3,4.5 4.8,5 5.5))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('POLYGON((4 4,6 6,8 8,10 15))'));

SELECT ST_Distance(g,GeomFromText(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,multipolygon
SELECT ST_Distance(GeomFromText(@star),GeomFromText(@star_of_elems));

SELECT ST_Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star_of_elems));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTIPOLYGON(((110 110,-100 100,-50 50)))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('MULTIPOLYGON(((5 0,20 20,100 100)),((0 0,-10 -10,10 100)))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTIPOLYGON(((4.3 4.3,4.7 5,5 5.6)))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('MULTIPOLYGON(((4 4,6 6,8 8,10 15)))'));

SELECT ST_Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # polygon,geometrycollection
SELECT ST_Distance(GeomFromText(@star),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText(@star_elem_vertical),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText(@star),GeomFromText(@star_collection_multilinestr));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 15)))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4,4 4))'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=100;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,point
SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star_top));

SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText('POINT(30 30)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('POINT(0 8)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('POINT(20 20)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('POINT(5 5)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('POINT(15 15)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('POINT(16.1 16.1)'));

SELECT ST_Distance(g,GeomFromText(@star_top)) FROM gis_geometrycollection WHERE fid=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,multipoint
SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star_bottom_points));

SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText('MULTIPOINT(30 30,0 35)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTIPOINT(0 8,100 100)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTIPOINT(50 50,-30 50)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTIPOINT(4.5 4.5,5.5 5.5)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTIPOINT(15.9 15.9)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTIPOINT(19 19,100 100)'));

SELECT ST_Distance(g,GeomFromText(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,linestring
SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star_top_to_center));

SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText('LINESTRING(30 30,0 35)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('LINESTRING(0 8,100 100)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('LINESTRING(50 50,-30 50)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('LINESTRING(4.5 4.5,5.5 5.5)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('LINESTRING(14.5 14.5,15.5 15.5)'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('LINESTRING(19 19,100 100)'));

SELECT ST_Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,multilinestring
SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star_lines_near_vertical));

SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText('MULTILINESTRING((0 30,30 30,0 35))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTILINESTRING((0 8,10 10,20 20),(50 50,75 75,100 100))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTILINESTRING((50 50,100 50),(-50 50,-40 50))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTILINESTRING((14.5 14.5,15.5 15.5))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTILINESTRING((-10 -10,50 50,100 100))'));

SELECT ST_Distance(g,GeomFromText(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,polygon
SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star_elem_vertical));

SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star));

SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText('POLYGON((0 0,15 25,35 0,0 0))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('POLYGON((10 10,10 -10,-10 -10,-10 10,10 10))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('POLYGON((20 20,20 30,30 30,30 20,20 20))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('POLYGON((4 4,4 6,6 6,6 4,4 4))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('POLYGON((14.5 14.5,14.5 15.5,15.5 15.5))'));

SELECT ST_Distance(g,GeomFromText(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,multipolygon
SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star_of_elems));

SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText('MULTIPOLYGON(((0 0,15 25,35 0,0 0),(5 0,15 25,25 0,15 5,5 0)))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTIPOLYGON(((10 10,10 -10,-10 -10,-10 10,10 10)))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('MULTIPOLYGON(((20 20,20 30,30 30,30 20,20 20)))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTIPOLYGON(((4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('MULTIPOLYGON(((14.5 14.5,14.5 15.5,15.5 15.5)))'));

SELECT ST_Distance(g,GeomFromText(@star_of_elems)) FROM gis_geometrycollection WHERE fid=103;

SELECT ST_Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

SELECT ST_Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--echo #-------------------------------------------------------------------------------------------
--echo # multipolygon,geometrycollection
SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star_collection_elems_3));

SELECT ST_Distance(GeomFromText(@star_of_elems),GeomFromText(@star_collection_multilinestr));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 55)))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 4,4 4,0 0)),((0 5,0 10,10 5,0 5)))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),((4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(GeomFromText('MULTIPOLYGON(((0 0,0 10,10 10,10 0),(4 4,4 6,6 6,6 4)),((10 10,10 20,20 20,20 10),(14 14,14 16,16 16,16 14)))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)),POLYGON((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))'));

SELECT ST_Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=103;

SELECT ST_Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=215;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,point
SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_top));

SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText('POINT(30 30)'));

SELECT ST_Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('POINT(30 30)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('POINT(0 0)'));

Select ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('POINT(100 100)'));

Select ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(),POLYGON((0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('POINT(100 100)'));

Select ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)),GEOMETRYCOLLECTION())'),GeomFromText('POINT(100 100)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('POINT(20 20)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('POINT(5 5)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('POINT(15 15)'));

SELECT ST_Distance(g,GeomFromText(@star_top)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,multipoint
SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_bottom_points));

SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText('MULTIPOINT(30 30,0 35)'));

SELECT ST_Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('MULTIPOINT(30 30,0 35)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('MULTIPOINT(0 0,100 100)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(LINESTRING(0 0,10 10,20 20),GEOMETRYCOLLECTION())'),ST_GeomFromText('MULTIPOINT(5 0,10 0)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('MULTIPOINT(20 20,40 40,60 60)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTIPOINT(4.5 4.5,5.5 5.5)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('MULTIPOINT(4 4,6 6,8 8)'));

SELECT ST_Distance(g,GeomFromText(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,linestring
SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_top_to_center));

SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText('LINESTRING(30 30,0 35)'));

SELECT ST_Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('LINESTRING(30 30,0 35)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('LINESTRING(0 0,100 100)'));

Select ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('LINESTRING(0 0,10 10)'));

Select ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(),POLYGON((0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('LINESTRING(0 0,10 10)'));

Select ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)),GEOMETRYCOLLECTION())'),GeomFromText('LINESTRING(0 0,10 10)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('LINESTRING(20 20,40 40,60 60)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(LINESTRING(0 0,10 10,20 20))'),ST_GeomFromText('LINESTRING(5 0,10 0)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(LINESTRING(0 0,10 10,20 20),GEOMETRYCOLLECTION())'),ST_GeomFromText('LINESTRING(5 0,10 0)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('LINESTRING(4.5 4.5,5.5 5.5)'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('LINESTRING(4 4,6 6,8 8)'));

SELECT ST_Distance(g,GeomFromText(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,multilinestring
SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_lines_near_vertical));

SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText('MULTILINESTRING((0 30,30 30,0 35))'));

SELECT ST_Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('MULTILINESTRING((0 30,30 30,0 35))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('MULTILINESTRING((0 0,100 100))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('MULTILINESTRING((20 20,40 40),(60 60))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTILINESTRING((4.5 4.5,5.5 5.5))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('MULTILINESTRING((4 4,6 6),(8 8,10 10))'));

SELECT ST_Distance(g,GeomFromText(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,polygon
SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_elem_vertical));

SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText(@star));

SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText('POLYGON((0 0,15 25,35 0,0 0))'));

SELECT ST_Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('POLYGON((0 0,15 25,35 0,0 0))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('POLYGON((0 0,30 40,90 100))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('POLYGON((20 20,40 40,50 60))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('POLYGON((4.2 4.2,5 5,5.7 5.8))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('POLYGON((4 4,6 6,8 8,10 20))'));

SELECT ST_Distance(g,GeomFromText(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=115;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,multipolygon
SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_of_elems));

SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText('MULTIPOLYGON(((0 0,15 25,35 0,0 0),(5 0,15 25,25 0,15 5,5 0)))'));

SELECT ST_Distance(GeomFromText(@star_collection_multilinestr),GeomFromText('MULTIPOLYGON(((0 0,15 25,35 0,0 0),(5 0,15 25,25 0,15 5,5 0)))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('MULTIPOLYGON(((0 0,30 40,90 100)))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('MULTIPOLYGON(((20 20,40 40,50 60)))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('MULTIPOLYGON(((4.2 4.2,5 5,5.7 5.8)))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('MULTIPOLYGON(((4 4,6 6,8 8,10 20)))'));

SELECT ST_Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=115;

SELECT ST_Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=115 and fid2=103;

--echo #-------------------------------------------------------------------------------------------
--echo # geometrycollection,geometrycollection
SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_collection_elems));

SELECT ST_Distance(GeomFromText(@star_collection_elems),GeomFromText(@star_collection_elems_3));

SELECT ST_Distance(GeomFromText(@star_collection_multilinestr),GeomFromText(@star_collection_elems_3));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(50 50)))'),GeomFromText('GEOMETRYCOLLECTION(POINT(0 0),LINESTRING(0 0,50 0,100 0))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(POLYGON((20 20,20 30,30 30,30 20,20 20),(0 0,0 10,10 10,10 0,0 0)))'),GeomFromText('GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0)))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(LINESTRING(1 1,2 2,3 3,4 4))),POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4)))'),GeomFromText('GEOMETRYCOLLECTION(MULTIPOINT(4.5 4.5,5.5 5.5))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,0 10,10 10,10 0,0 0),(4 4,4 6,6 6,6 4,4 4))),GEOMETRYCOLLECTION(MULTIPOLYGON(((3 3,3 7,7 7,7 3,3 3),(4 4,4 6,6 6,6 4,4 4)))))'),GeomFromText('GEOMETRYCOLLECTION(MULTILINESTRING((40 40,50 50),(5 5)))'));

SELECT ST_Distance(g,GeomFromText(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=115;

SELECT ST_Distance(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=115 and fid2=215;

--echo #====================================================================================
--echo # Distance() with 2 geometries of same SRID
--echo #====================================================================================

SELECT Distance(GeomFromText(@star_top,0),GeomFromText(@star_center,0));

SELECT Distance(GeomFromText(@star_top,100),GeomFromText(@star_center,100));

SELECT Distance(GeomFromText(@star_top,20000),GeomFromText(@star_center,20000));

SELECT Distance(GeomFromText(@star_top,123456),GeomFromText(@star_center,123456));

SELECT Distance(GeomFromText(@star_top,1048575),GeomFromText(@star_center,1048575));

SELECT Distance(GeomFromText(@star_top,4294967295),GeomFromText(@star_center,4294967295));

SELECT Distance(GeomFromText(@star_top,-1),GeomFromText(@star_center,-1));

SELECT Distance(GeomFromText(@star_top,-1024),GeomFromText(@star_center,-1024));

SELECT Distance(GeomFromText(@star_top,4294967295000),GeomFromText(@star_center,4294967295000));

--echo #====================================================================================
--echo # ST_Distance() with 2 geometries of same SRID
--echo #====================================================================================

SELECT ST_Distance(GeomFromText(@star_top,0),GeomFromText(@star_center,0));

SELECT ST_Distance(GeomFromText(@star_top,100),GeomFromText(@star_center,100));

SELECT ST_Distance(GeomFromText(@star_top,20000),GeomFromText(@star_center,20000));

SELECT ST_Distance(GeomFromText(@star_top,123456),GeomFromText(@star_center,123456));

SELECT ST_Distance(GeomFromText(@star_top,1048575),GeomFromText(@star_center,1048575));

SELECT ST_Distance(GeomFromText(@star_top,4294967295),GeomFromText(@star_center,4294967295));

SELECT ST_Distance(GeomFromText(@star_top,-1),GeomFromText(@star_center,-1));

SELECT ST_Distance(GeomFromText(@star_top,-1024),GeomFromText(@star_center,-1024));

SELECT ST_Distance(GeomFromText(@star_top,4294967295000),GeomFromText(@star_center,4294967295000));

--echo #=======================================================================================
--echo # Invalid function calls
--echo #=======================================================================================

--echo #---------------------------------------------------------------------------------------
--echo # Distance()
--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT Distance();

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT Distance(GeomFromText('POINT(10 10)'));

SELECT Distance(GeomFromText('POINT(10 10)'),NULL);

SELECT Distance(NULL,GeomFromText('POINT(10 10)'));

--error ER_GIS_DIFFERENT_SRIDS
SELECT Distance(GeomFromText(@star_top),GeomFromText(@star_center,4326));

--error ER_GIS_DIFFERENT_SRIDS
SELECT Distance(GeomFromText(@star_top,1048576),GeomFromText(@star_center,4326));

SELECT Distance(NULL,GeomFromText(@star_top));

SELECT Distance(GeomFromText(@star_of_elems),NULL);

SELECT Distance(NULL,NULL);

SELECT Distance(g,NULL) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

SELECT Distance(fid,NULL) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--error ER_GIS_INVALID_DATA
SELECT Distance(fid,GeomFromText(@star_top)) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText(@star_of_elems),fid) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('POINT(a 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('POINT(! 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_PARSE_ERROR
SELECT Distance(GeomFromText('POINT('!' 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('POINT(12,34 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('LINESTRING(a 0,10 10)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('LINESTRING(0 0,! 10)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_PARSE_ERROR
SELECT Distance(GeomFromText('LINESTRING('!' 0,10 10)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('LINESTRING(12,34 0,10 10)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('POLYGON((a 0,10 10,10 0,0 0))'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('POLYGON((0 0,! 10,10 0,0 0))'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_PARSE_ERROR
SELECT Distance(GeomFromText('POLYGON(('!' 0,10 10,10 0,0 0))'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('POLYGON((12,34 0,10 10,10 0,0 0))'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('POLYGON((12,34 0,10 10,10 0,0 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT Distance(g,GeomFromText('POLYGON((11 15,19 15,11 15))')) FROM gis_geometrycollection WHERE fid=110;

--error ER_GIS_INVALID_DATA
SELECT Distance(g,GeomFromText('MULTIPOLYGON(((11 15,19 15,11 15)),((25 0,0 15,25 0)))')) FROM gis_geometrycollection WHERE fid=110;

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('POLYGON((11 11,14 14,15 15,16 16,20 20))'));

--error ER_GIS_INVALID_DATA
SELECT Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('MULTIPOLYGON(((11 11,14 14,15 15)),((16 16,20 20,30 30)))'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION()'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'));

SELECT Distance(GeomFromText('POINT(10 10)'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'));

SELECT Distance(GeomFromText('GEOMETRYCOLLECTION()'),GeomFromText('POINT(10 10)'));

--error ER_PARSE_ERROR
SELECT Distance(,);

--error ER_PARSE_ERROR
SELECT Distance(GeomFromText(@star_of_elems),);

--error ER_PARSE_ERROR
SELECT Distance(,GeomFromText(@star_top));

--echo #---------------------------------------------------------------------------------------
--echo # ST_Distance()
--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_Distance();

--error ER_WRONG_PARAMCOUNT_TO_NATIVE_FCT
SELECT ST_Distance(GeomFromText('POINT(10 10)'));

SELECT ST_Distance(GeomFromText('POINT(10 10)'),NULL);

SELECT ST_Distance(NULL,GeomFromText('POINT(10 10)'));

--error ER_GIS_DIFFERENT_SRIDS
SELECT ST_Distance(GeomFromText(@star_top),GeomFromText(@star_center,4326));

--error ER_GIS_DIFFERENT_SRIDS
SELECT ST_Distance(GeomFromText(@star_top,1048576),GeomFromText(@star_center,4326));

SELECT ST_Distance(NULL,GeomFromText(@star_top));

SELECT ST_Distance(GeomFromText(@star_of_elems),NULL);

SELECT ST_Distance(NULL,NULL);

SELECT ST_Distance(g,NULL) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

SELECT ST_Distance(fid,NULL) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(fid,GeomFromText(@star_top)) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText(@star_of_elems),fid) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('POINT(a 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('POINT(! 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_PARSE_ERROR
SELECT ST_Distance(GeomFromText('POINT('!' 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('POINT(12,34 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('LINESTRING(a 0,10 10)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('LINESTRING(0 0,! 10)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_PARSE_ERROR
SELECT ST_Distance(GeomFromText('LINESTRING('!' 0,10 10)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('LINESTRING(12,34 0,10 10)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('POLYGON((a 0,10 10,10 0,0 0))'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('POLYGON((0 0,! 10,10 0,0 0))'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_PARSE_ERROR
SELECT ST_Distance(GeomFromText('POLYGON(('!' 0,10 10,10 0,0 0))'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('POLYGON((12,34 0,10 10,10 0,0 0))'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('POLYGON((12,34 0,10 10,10 0,0 0)'),GeomFromText('LINESTRING(0 0,10 10)'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(g,GeomFromText('POLYGON((11 15,19 15,11 15))')) FROM gis_geometrycollection WHERE fid=110;

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(g,GeomFromText('MULTIPOLYGON(((11 15,19 15,11 15)),((25 0,0 15,25 0)))')) FROM gis_geometrycollection WHERE fid=110;

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('POLYGON((11 11,14 14,15 15,16 16,20 20))'));

--error ER_GIS_INVALID_DATA
SELECT ST_Distance(GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0),(14 14,14 16,16 16,16 14,14 14))'),GeomFromText('MULTIPOLYGON(((11 11,14 14,15 15)),((16 16,20 20,30 30)))'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION()'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'));

SELECT ST_Distance(GeomFromText('POINT(10 10)'),GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'));

SELECT ST_Distance(GeomFromText('GEOMETRYCOLLECTION()'),GeomFromText('POINT(10 10)'));

--error ER_PARSE_ERROR
SELECT ST_Distance(,);

--error ER_PARSE_ERROR
SELECT ST_Distance(GeomFromText(@star_of_elems),);

--error ER_PARSE_ERROR
SELECT ST_Distance(,GeomFromText(@star_top));

--echo #clean up
--disable_warnings
DROP TABLE IF EXISTS gis_geometrycollection;
DROP TABLE IF EXISTS gis_geometrycollection_2;
--enable_warnings
