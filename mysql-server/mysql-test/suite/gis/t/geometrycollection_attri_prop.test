###############################################################################
#                                                                             #
# This test is aimed to focus on the properties and attributes of the         #
# Geometry collection class                                                   #
#                                                                             #
# The Geometry collection class has a number of properties                    #
# that are specific to Geometry collection and certain                        #
# properties that are common to all Geometry subclasses                       #
#                                                                             #
# Creation Date: 2013-10-16                                                   #
# Author : Tanjot Singh Uppal                                                 #
#                                                                             #
# Description:Test Cases of the Geometry collection class Properties          #
#                                                                             #
###############################################################################


--source include/force_myisam_default.inc
--source include/not_embedded.inc
--source include/have_geometry.inc

#Confirming the storage engine
--echo #Confirming the storage engine
SHOW VARIABLES LIKE '%engine%';

############################################################################################
# Creating the spatial objects                                                             #
############################################################################################

--echo #Creating the spatial Geometry object
USE test;

--disable_warnings
DROP TABLE IF EXISTS gis_geometrycollection;
--enable_warnings

CREATE TABLE gis_geometrycollection (fid INTEGER NOT NULL PRIMARY KEY, g GEOMETRYCOLLECTION);

############################################################################################
# Inserting the values specific to the spatial objects                                     #
############################################################################################

--echo #INSERT Points and MultiPoints to the Geometry Collection class
--disable_warnings
--error ER_GIS_INVALID_DATA
INSERT INTO gis_geometrycollection VALUES
(101, PointFromText('POINT(10 10)')),
(102, PointFromWKB(AsWKB(PointFromText('POINT(7895647.28374652763484 -00000000.112323454345)')))),
(103, PointFromText('POINT(0 0)')),
(104, PointFromText('POINT(-0 -0)')),
(105, PointFromWKB(AsWKB(PointFromText('POINT(5.49 -6.49)')))),
(106, PointFromWKB(AsWKB(PointFromText('POINT(-1 -0.0)')))),
(107, PointFromWKB(AsWKB(PointFromText('POINT(99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999 99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999)')))),
(108, PointFromText('POINT(ô ô)')),
(109, PointFromWKB(AsWKB(PointFromText('POINT(NULL)')))),
(110, PointFromWKB(AsWKB(PointFromText('POINT(76113476 0897645637)')))),
(401, MultiPointFromText('MULTIPOINT(0 0,10 10,10 20,20 20)')),
(402, MPointFromText('MULTIPOINT(1 1,11 11,11 21,21 21)')),
(403, MPointFromWKB(AsWKB(MultiPoint(Point(3, 6), Point(4, 10))))),
(404, MultiPointFromText('MULTIPOINT(0 0, -0 0, 0.0, -0, -0.0 0.0)')),
(405, MPointFromText('MULTIPOINT(1 1, 10 1, 1 -1, 10 -1, 1 -2, 1 -2, 10 -2, 7 2, 7 -2, 4 2, 4 -2, 1 1)')),
(406, MPointFromWKB(AsWKB(MultiPoint(Point(3, 6), Point(4, 10))))),
(407, MultiPointFromText('MULTIPOINT(1 1, 10 1, 1 -1, 10 -1, 1 -2, 1 -2, 10 -2, 7 2, 7 -2, 4 2, 4 -2, 8 5)'));
--enable_warnings

--echo #INSERT Linestrings and MultiLinestrings to the Geometry Collection class
--disable_warnings
--error ER_GIS_INVALID_DATA
INSERT INTO gis_geometrycollection VALUES
(201, LineFromText('LINESTRING(0 0,0 10,10 0)')),
(202, LineFromText('LINESTRING(0.0 0.0, 0.0 0.0, 0.0 0.0)')),
(203, LineFromText('LINESTRING(1 1, 1 0, 0 0, 1 1)')),
(204, LineStringFromText('LINESTRING(1 0, 10 0, 5 1, 4 0, 1 0)')),
(205, LineStringFromText('LINESTRING(Ç Ç,Ç Ç,Ç Ç)')),
(206, LineStringFromText('LINESTRING(-1 -0.0, 0 0, -0 0.00000)')),
(207, LineStringFromWKB(AsWKB(LineString(Point(10, 'Ç'), Point(0.1, 10.10), Point(-00000, -111111.00000))))),
(208, LineStringFromWKB(AsWKB(LineString(Point(100, 100), Point(100, 100), Point(100, 100))))),
(209, LineStringFromText('LINESTRING(1 10, 1 0, 10 0, -5 10)')),
(501, MultiLineStringFromText('MULTILINESTRING((0 0, 1 0, 2 0, 3 0, 4 0, 5 0, 0 0),(2 0, 3 0))')),
(502, MLineFromText('MULTILINESTRING((2 2, 3 2, 4 2), (5 2, 6 2, 7 2)), ((9 2, 10 2, 11 2))')),
(503, MLineFromWKB(AsWKB(MultiLineString(LineString(Point(0, 0), Point(10, 10)), LineString(Point(10, 0), Point(0, 10)), LineString(Point(0, 5), Point(10, 5)), LineString(Point(5, 0), Point(5, 10)))))),
(504, MultiLineStringFromText('MULTILINESTRING((0 0, 1 0, 2 0, 3 0, 4 0, 5 0, 0 0),(2 0, 3 0, 2 0)), ((2 0, 3 0, 2 0))')),
(505, MLineFromText('MULTILINESTRING((2 0, 3 0, 2 0)), (0 0, 1 0, 2 0, 3 0, 4 0, 5 0, 0 0)), ((2 0, 3 0, 2 0))'));
--enable_warnings

--echo #INSERT Polygons and MultiPolygons to the Geometry Collection class
--disable_warnings
--error ER_GIS_INVALID_DATA
INSERT INTO gis_geometrycollection VALUES
(301, PolygonFromText('POLYGON((1 0, 100 0, 1 -1, 100 -1, 1 -2, 100 -2, 0 -3, 1 0))')),
(302, PolyFromText('POLYGON((1 0, 100 0, 100 100, 1 100, 1 0), (20 20, 80 20, 80 80, 20 80, 20 20))')),
(303, PolyFromWKB(AsWKB(Polygon(LineString(Point(8, 8), Point(8, 8), Point(8, 8), Point(8, 8)))))),
(304, PolygonFromText('POLYGON((10 10,20 10,20 20,10 20,10 10),(15 10, 20 10, 20 20, 15 20, 15 10))')),
(305, PolygonFromText('POLYGON((10 10,20 10,20 20,10 20,10 10),(10 10,20 10,20 20,10 20,10 10))')),
(306, PolyFromText('POLYGON((20 20, 80 20, 80 80, 20 80, 20 20), (1 0, 100 0, 100 100, 1 100, 1 0))')),
(307, PolyFromText('POLYGON((20 20, 80 20, 80 80, 20 80, 20 20)), ((1 0, 100 0, 100 100, 1 100, 1 0))')),
(308, PolygonFromText('POLYGON((0 0, 1 0, 2 0, 3 0, 4 0, 5 0, 0 0))')),
(309, PolyFromText('POLYGON((0 0, 1 0, 2 0, 3 0, 4 0, 5 0, 0 0), (2 0, 3 0, 2 0))')),
(310, PolygonFromText('POLYGON((Ç Ç,Ç Ç,Ç Ç,Ç Ç,Ç Ç,Ç Ç,Ç Ç,Ç Ç)))')),
(311, PolyFromWKB(AsWKB(Polygon(LineString(Point(-0, -0), Point(0.1, -0.0), Point(0, 0)))))),
(601, MultiPolygonFromText('MULTIPOLYGON(((10 10,20 10,20 20,10 20,10 10),(15 10, 20 10, 20 20, 15 20, 15 10)), ((15 10, 20 10, 20 20, 15 20, 15 10)))')),
(602, MPolyFromText('MULTIPOLYGON(((10 10,20 10,20 20,10 20,10 10),(15 10, 20 10, 20 20, 15 20, 15 10)), ((1 0, 8 0, 8 -8, 1 -8, 1 0)))')),
(603, MPolyFromWKB(AsWKB(MultiPolygon(Polygon(LineString(Point(0, 3), Point(3, 3), Point(3, 0), Point(0, 3))))))),
(604, MultiPolygonFromText('MULTIPOLYGON(((1 0, 1 1, 2 0, 1 0),(2 0, 1 1, 2 1, 2 0)),((2 0, 2 1, 3 1, 2 0)))')),
(605, MPolyFromText('MULTIPOLYGON(((1 0, 1 1, 2 0, 1 0)),((2 0, 1 1, 2 1, 2 0)), ((2 0, 2 1, 3 1, 2 0)))')),
(606, MPolyFromText('MULTIPOLYGON(((1 0, 4 0, 4 4, 1 4, 1 0)),((2 0, 6 0, 6 4, 2 4, 2 0)), ((1.5 0, 5 0, 5 4, 1.5 4, 1.5 0)))')),
(607, MPolyFromWKB(AsWKB(MultiPolygon(Polygon(LineString(Point(0, 0), Point(0, 0), Point(0, 0), Point(0, 0)))))));
--enable_warnings

--echo #INSERT different geometry types to the Geometry Collection class
--disable_warnings
--error ER_GIS_INVALID_DATA
INSERT INTO gis_geometrycollection VALUES
(701, GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10))')),
(702, GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))')),
(703, GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111)))))),
(704, GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), MULTIPOLYGON(((28 26,28 0,84 0,84 42,28 26),(52 18,66 23,73 9,48 6,52 18)),((59 18,67 18,67 13,59 13,59 18))), MULTILINESTRING((10 48,10 21,10 0),(16 0,16 23,16 48)), LINESTRING(0 0,10 10), MULTIPOINT(0 0,10 10,10 20,20 20), POLYGON((0 0,50 0,50 50,0 50,0 0), (10 10,20 10,20 20,10 20,10 10)))')),
(705, GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(99, 0.99), MULTIPOLYGON(((10 10, 20 10, 15 0, 10 10)),((10 1, 20 1, 15 11, 10 1)),((11 0.5, 19 0.5, 19 19, 11 19, 11 0.5))), MULTILINESTRING((11 0.5, 19 19),(19 0.5, 11 19)), LINESTRING(10 10, 20 0), MULTIPOINT(11 0.5, 19 0.5, 19 19, 11 19), POLYGON((10 10, 20 10, 20 0, 10 0, 10 10), (11 0.5, 19 0.5, 19 19, 11 19, 11 0.5)))')),
(706, GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10)), MULTIPOINT(point(0, 0), point(10, 10), point(10, 20), point(20, 20)), POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2), Point(1, 1), Point(10, 20))))))),
(707, GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), MULTIPOLYGON(((0 0, 0 0, 0 0, 0 0),(0 0, 0 0, 0 0, 0 0)),((0 0, 0 0, 0 0, 0 0))), MULTILINESTRING((0 0, 0 0, 0 0, 0 0),(0 0, 0 0, 0 0, 0 0)), LINESTRING(0 0, 0 0, 0 0, 0 0), MULTIPOINT(0 0, 0 0, 0 0, 0 0), POLYGON((0 0, 0 0, 0 0, 0 0), (0 0, 0 0, 0 0, 0 0)))')),
(708, GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0), MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(0, 0), Point(0, 0), Point(0, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point(0, 0), point(0, 0), point(0, 0)), LINESTRING(point(0, 0), point(0, 0), point(0, 0))), LINESTRING(point(0, 0),point(0, 0)), MULTIPOINT(point(0, 0), point(0, 0), point(0, 0), point(0, 0)), POLYGON(LineString(Point(0, 0), Point(0, 0), Point(0, 0), Point(0, 0), Point(0, 0)))))));
--enable_warnings

--echo #Checking the integrity of the above insert statements 
select count(g) from gis_geometrycollection;

select count(astext(g)) from gis_geometrycollection;

select count(distinct(g)) from gis_geometrycollection;

select count(distinct(astext(g))) from gis_geometrycollection;


############################################################################################
# Displaying the spatial data from all the spatial objects created                         #
############################################################################################

--echo #Displaying the inserted spatial Data
Select fid, AsText(g) from gis_geometrycollection;

############################################################################################
# Checking the geometry types for the geometrycollection class                             #
############################################################################################

--echo #Checking the geometry types for the geometrycollection class
select fid,GeometryType(g) from gis_geometrycollection where g is not NULL;
select count(GeometryType(g)) FROM gis_geometrycollection;


--echo #Checking the geometry types of some random Geometry Collections.
--disable_Warnings
Select GeometryType(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));

Select GeometryType(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))'));

Select GeometryType(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111))))));

Select GeometryType(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

Select GeometryType(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select GeometryType(GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

Select GeometryType(GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0),MULTIPOINT(point(0, 0), point(1, 1)), LINESTRING(point(0, 0),point(10, 10)),MULTILINESTRING(LINESTRING(point(1, 2), point(1, 3))),POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2))),MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(1, 0), Point(1, 1),Point(0, 0))))))));


--echo #WKB data, little-endian format
Select GeometryType(GeometryFromWKB(0x0107000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440));

Select GeometryType(GeometryFromWKB(0x0107000000030000000101000000000000000000144000000000000014400102000000020000000000000000000000000000000000000000000000000024400000000000002440010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000000));

Select GeometryType(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40));


--echo #WKB data, big-endian format
Select GeometryType(GeometryFromWKB(0x0000000007000000020000000001000000000000000000000000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000));

Select GeometryType(GeometryFromWKB(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000));

Select GeometryType(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000));


--error ER_GIS_INVALID_DATA
Select GeometryType(GeomCollFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()), POLYGON(()))'));

--error ER_GIS_INVALID_DATA
Select GeometryType(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON((), ()))'));

--ERROR 1064
Select GeometryType(GeometryFromWKB(AsWKB(GeometryCollection(Point(), Point(),LineString(Point(), Point())))));
--error ER_GIS_INVALID_DATA
Select GeometryType(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((),()),(())), MULTILINESTRING((),()), MULTIPOINT())'));

--error ER_GIS_INVALID_DATA
Select GeometryType(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()))'));

--ERROR 1064
Select GeometryType(GeometryFromWKB(AsWKB(GeometryCollection(POINT(), MULTIPOLYGON(Polygon(LineString(Point(), Point(), Point(), Point()))), MULTILINESTRING(LINESTRING(point(), point(), point()), LINESTRING(point(), point(), point())), LINESTRING(point(),point())))));

--error ER_GIS_INVALID_DATA
Select GeometryType(GeomCollFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

--error ER_GIS_INVALID_DATA
Select GeometryType(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ), (ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select GeometryType(GeometryFromWKB(AsWKB(GeometryCollection(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'),LineString(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'))))));

--error ER_GIS_INVALID_DATA
Select GeometryType(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((@ $),(% -&)),((1, 2))), MULTILINESTRING((@ $, % -&, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

--error ER_GIS_INVALID_DATA
Select GeometryType(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(@ $), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select GeometryType(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));


Select GeometryType(GeomCollFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0)), POLYGON((5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select GeometryType(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0), (5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select GeometryType(GeometryFromWKB(AsWKB(GeometryCollection(Point(5, 5), Point(0.0009, 0.0),LineString(Point(4.999999, 4.999999), Point(9.99999, 9.99999))))));

Select GeometryType(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0),(4 4, 6 4, 6 8, 4 8, 4 4)),((4 4, 6 4, 6 8, 4 8, 4 4))), MULTILINESTRING((0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999),(0 10, 5 5, 10 10)), MULTIPOINT(0 10, 5 5, 10 10))'));

Select GeometryType(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select GeometryType(GeometryFromWKB(AsWKB(GeometryCollection(POINT(5, 5), MULTIPOLYGON(Polygon(LineString(Point(0.0009, 0.0), Point(4.999999, 4.999999), Point(15, 0), Point(0.0009, 0)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

--enable_warnings

--echo #Invalid WKB data
--error ER_GIS_DATA_WRONG_ENDIANESS
Select GeometryType(0x0104000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select GeometryType(0x0000000006000000020000000001BFF0000000000000C130F44700000000000000000300000001000000050000000000000000000000000000000000000000000000004014000000000000401400000000000040140000000000004014000000000000000000000000000000000000000000000000000000000000);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select GeometryType(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000);

############################################################################################
# Checking the SRID for the geometrycollection class                                       #
############################################################################################

--echo #Checking the SRID for the geometrycollection class
select fid,SRID(g) from gis_geometrycollection where g is not NULL;
select count(SRID(g)) FROM gis_geometrycollection;


--echo #Checking the geometry types of some random Geometry Collections.
--disable_Warnings
Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));

Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))'));

Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111))))));

Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0),MULTIPOINT(point(0, 0), point(1, 1)), LINESTRING(point(0, 0),point(10, 10)),MULTILINESTRING(LINESTRING(point(1, 2), point(1, 3))),POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2))),MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(1, 0), Point(1, 1),Point(0, 0))))))));


--echo #WKB data, little-endian format
Select SRID(GeometryFromWKB(0x0107000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440));

Select SRID(GeometryFromWKB(0x0107000000030000000101000000000000000000144000000000000014400102000000020000000000000000000000000000000000000000000000000024400000000000002440010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000000));

Select SRID(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40));


--echo #WKB data, big-endian format
Select SRID(GeometryFromWKB(0x0000000007000000020000000001000000000000000000000000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000));

Select SRID(GeometryFromWKB(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000));

Select SRID(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000));


--error ER_GIS_INVALID_DATA
Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()), POLYGON(()))'));

--error ER_GIS_INVALID_DATA
Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON((), ()))'));

--ERROR 1064
Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(Point(), Point(),LineString(Point(), Point())))));
--error ER_GIS_INVALID_DATA
Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((),()),(())), MULTILINESTRING((),()), MULTIPOINT())'));

--error ER_GIS_INVALID_DATA
Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()))'));

--ERROR 1064
Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(POINT(), MULTIPOLYGON(Polygon(LineString(Point(), Point(), Point(), Point()))), MULTILINESTRING(LINESTRING(point(), point(), point()), LINESTRING(point(), point(), point())), LINESTRING(point(),point())))));

--error ER_GIS_INVALID_DATA
Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

--error ER_GIS_INVALID_DATA
Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ), (ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'),LineString(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'))))));

--error ER_GIS_INVALID_DATA
Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((@ $),(% -&)),((1, 2))), MULTILINESTRING((@ $, % -&, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

--error ER_GIS_INVALID_DATA
Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(@ $), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));


Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0)), POLYGON((5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0), (5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(Point(5, 5), Point(0.0009, 0.0),LineString(Point(4.999999, 4.999999), Point(9.99999, 9.99999))))));

Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0),(4 4, 6 4, 6 8, 4 8, 4 4)),((4 4, 6 4, 6 8, 4 8, 4 4))), MULTILINESTRING((0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999),(0 10, 5 5, 10 10)), MULTIPOINT(0 10, 5 5, 10 10))'));

Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(POINT(5, 5), MULTIPOLYGON(Polygon(LineString(Point(0.0009, 0.0), Point(4.999999, 4.999999), Point(15, 0), Point(0.0009, 0)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

--enable_warnings

Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))',0));

Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))',1000));

Select SRID(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000,123456));

Select SRID(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40,123456789));

Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111)))),20000));

Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))',4294967295));


Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))',-1));

Select SRID(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))',-1024));

Select SRID(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000,1234567891234));

Select SRID(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40,4294967296));

Select SRID(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111)))),429496729510));

Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))',42949672950000));


--echo #Invalid WKB data
--error ER_GIS_DATA_WRONG_ENDIANESS
Select SRID(0x0104000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select SRID(0x0000000006000000020000000001BFF0000000000000C130F44700000000000000000300000001000000050000000000000000000000000000000000000000000000004014000000000000401400000000000040140000000000004014000000000000000000000000000000000000000000000000000000000000);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select SRID(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000);

############################################################################################
# Checking the Dimension for the geometrycollection class                                  #
############################################################################################

--echo #Checking the Dimension for the geometrycollection class 
select fid,Dimension(g) from gis_geometrycollection where g is not NULL;
select count(Dimension(g)) FROM gis_geometrycollection;


--echo #Checking the geometry types of some random Geometry Collections.
--disable_Warnings
Select Dimension(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));

Select Dimension(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))'));

Select Dimension(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111))))));

Select Dimension(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

Select Dimension(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select Dimension(GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

Select Dimension(GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0),MULTIPOINT(point(0, 0), point(1, 1)), LINESTRING(point(0, 0),point(10, 10)),MULTILINESTRING(LINESTRING(point(1, 2), point(1, 3))),POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2))),MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(1, 0), Point(1, 1),Point(0, 0))))))));


--echo #WKB data, little-endian format
Select Dimension(GeometryFromWKB(0x0107000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440));

Select Dimension(GeometryFromWKB(0x0107000000030000000101000000000000000000144000000000000014400102000000020000000000000000000000000000000000000000000000000024400000000000002440010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000000));

Select Dimension(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40));


--echo #WKB data, big-endian format
Select Dimension(GeometryFromWKB(0x0000000007000000020000000001000000000000000000000000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000));

Select Dimension(GeometryFromWKB(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000));

Select Dimension(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000));


--error ER_GIS_INVALID_DATA
Select Dimension(GeomCollFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()), POLYGON(()))'));

--error ER_GIS_INVALID_DATA
Select Dimension(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON((), ()))'));

--ERROR 1064
Select Dimension(GeometryFromWKB(AsWKB(GeometryCollection(Point(), Point(),LineString(Point(), Point())))));
--error ER_GIS_INVALID_DATA
Select Dimension(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((),()),(())), MULTILINESTRING((),()), MULTIPOINT())'));

--error ER_GIS_INVALID_DATA
Select Dimension(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()))'));

--ERROR 1064
Select Dimension(GeometryFromWKB(AsWKB(GeometryCollection(POINT(), MULTIPOLYGON(Polygon(LineString(Point(), Point(), Point(), Point()))), MULTILINESTRING(LINESTRING(point(), point(), point()), LINESTRING(point(), point(), point())), LINESTRING(point(),point())))));

--error ER_GIS_INVALID_DATA
Select Dimension(GeomCollFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

--error ER_GIS_INVALID_DATA
Select Dimension(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ), (ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select Dimension(GeometryFromWKB(AsWKB(GeometryCollection(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'),LineString(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'))))));

--error ER_GIS_INVALID_DATA
Select Dimension(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((@ $),(% -&)),((1, 2))), MULTILINESTRING((@ $, % -&, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

--error ER_GIS_INVALID_DATA
Select Dimension(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(@ $), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select Dimension(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));


Select Dimension(GeomCollFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0)), POLYGON((5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select Dimension(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0), (5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select Dimension(GeometryFromWKB(AsWKB(GeometryCollection(Point(5, 5), Point(0.0009, 0.0),LineString(Point(4.999999, 4.999999), Point(9.99999, 9.99999))))));

Select Dimension(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0),(4 4, 6 4, 6 8, 4 8, 4 4)),((4 4, 6 4, 6 8, 4 8, 4 4))), MULTILINESTRING((0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999),(0 10, 5 5, 10 10)), MULTIPOINT(0 10, 5 5, 10 10))'));

Select Dimension(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select Dimension(GeometryFromWKB(AsWKB(GeometryCollection(POINT(5, 5), MULTIPOLYGON(Polygon(LineString(Point(0.0009, 0.0), Point(4.999999, 4.999999), Point(15, 0), Point(0.0009, 0)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

--enable_warnings

--echo #Invalid WKB data
--error ER_GIS_DATA_WRONG_ENDIANESS
Select Dimension(0x0104000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select Dimension(0x0000000006000000020000000001BFF0000000000000C130F44700000000000000000300000001000000050000000000000000000000000000000000000000000000004014000000000000401400000000000040140000000000004014000000000000000000000000000000000000000000000000000000000000);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select Dimension(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000);

############################################################################################
# Checking the Envelope for the geometrycollection class                                   #
############################################################################################

--echo #Checking the Envelope for the geometrycollection class 
--error ER_GIS_INVALID_DATA
select fid,AsText(Envelope(g)) from gis_geometrycollection where g is not NULL;
--error ER_GIS_INVALID_DATA
select count(AsText(Envelope(g))) FROM gis_geometrycollection;


--echo #Checking the geometry types of some random Geometry Collections.
--disable_Warnings
Select AsText(Envelope(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))')));

Select AsText(Envelope(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))')));

Select AsText(Envelope(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111)))))));

Select AsText(Envelope(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))')));

Select AsText(Envelope(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))')));

Select AsText(Envelope(GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10)))))));

Select AsText(Envelope(GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0),MULTIPOINT(point(0, 0), point(1, 1)), LINESTRING(point(0, 0),point(10, 10)),MULTILINESTRING(LINESTRING(point(1, 2), point(1, 3))),POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2))),MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(1, 0), Point(1, 1),Point(0, 0)))))))));


--echo #WKB data, little-endian format
Select AsText(Envelope(GeometryFromWKB(0x0107000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440)));

Select AsText(Envelope(GeometryFromWKB(0x0107000000030000000101000000000000000000144000000000000014400102000000020000000000000000000000000000000000000000000000000024400000000000002440010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000000)));

Select AsText(Envelope(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40)));


--echo #WKB data, big-endian format
Select AsText(Envelope(GeometryFromWKB(0x0000000007000000020000000001000000000000000000000000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000)));

Select AsText(Envelope(GeometryFromWKB(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000)));

Select AsText(Envelope(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000)));


--error ER_GIS_INVALID_DATA
Select AsText(Envelope(GeomCollFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()), POLYGON(()))')));

--error ER_GIS_INVALID_DATA
Select AsText(Envelope(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON((), ()))')));

--ERROR 1064
Select AsText(Envelope(GeometryFromWKB(AsWKB(GeometryCollection(Point(), Point(),LineString(Point(), Point()))))));
--error ER_GIS_INVALID_DATA
Select AsText(Envelope(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((),()),(())), MULTILINESTRING((),()), MULTIPOINT())')));

--error ER_GIS_INVALID_DATA
Select AsText(Envelope(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()))')));

--ERROR 1064
Select AsText(Envelope(GeometryFromWKB(AsWKB(GeometryCollection(POINT(), MULTIPOLYGON(Polygon(LineString(Point(), Point(), Point(), Point()))), MULTILINESTRING(LINESTRING(point(), point(), point()), LINESTRING(point(), point(), point())), LINESTRING(point(),point()))))));

--error ER_GIS_INVALID_DATA
Select AsText(Envelope(GeomCollFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))')));

--error ER_GIS_INVALID_DATA
Select AsText(Envelope(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ), (ëô ôÑ, ëô ôÑ, ëô ôÑ)))')));

Select AsText(Envelope(GeometryFromWKB(AsWKB(GeometryCollection(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'),LineString(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ')))))));

--error ER_GIS_INVALID_DATA
Select AsText(Envelope(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((@ $),(% -&)),((1, 2))), MULTILINESTRING((@ $, % -&, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))')));

--error ER_GIS_INVALID_DATA
Select AsText(Envelope(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(@ $), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))')));

Select AsText(Envelope(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10)))))));


Select AsText(Envelope(GeomCollFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0)), POLYGON((5 -1, 11 5, 5 11, -1 5, 5 -1)))')));

Select AsText(Envelope(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0), (5 -1, 11 5, 5 11, -1 5, 5 -1)))')));

Select AsText(Envelope(GeometryFromWKB(AsWKB(GeometryCollection(Point(5, 5), Point(0.0009, 0.0),LineString(Point(4.999999, 4.999999), Point(9.99999, 9.99999)))))));

Select AsText(Envelope(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0),(4 4, 6 4, 6 8, 4 8, 4 4)),((4 4, 6 4, 6 8, 4 8, 4 4))), MULTILINESTRING((0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999),(0 10, 5 5, 10 10)), MULTIPOINT(0 10, 5 5, 10 10))')));

Select AsText(Envelope(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))')));

Select AsText(Envelope(GeometryFromWKB(AsWKB(GeometryCollection(POINT(5, 5), MULTIPOLYGON(Polygon(LineString(Point(0.0009, 0.0), Point(4.999999, 4.999999), Point(15, 0), Point(0.0009, 0)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10)))))));

--enable_warnings

--echo #Invalid WKB data
--error ER_GIS_DATA_WRONG_ENDIANESS
Select AsText(Envelope(0x0104000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440));
--error ER_GIS_DATA_WRONG_ENDIANESS
Select AsText(Envelope(0x0000000006000000020000000001BFF0000000000000C130F44700000000000000000300000001000000050000000000000000000000000000000000000000000000004014000000000000401400000000000040140000000000004014000000000000000000000000000000000000000000000000000000000000));
--error ER_GIS_DATA_WRONG_ENDIANESS
Select AsText(Envelope(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000));

############################################################################################
# Checking the IsSimple for the geometrycollection class                                   #
############################################################################################

--echo #Checking the IsSimple for the geometrycollection class 
select fid,IsSimple(g) from gis_geometrycollection where g is not NULL;
select count(IsSimple(g)) FROM gis_geometrycollection;


--echo #Checking the geometry types of some random Geometry Collections.
--disable_Warnings
Select IsSimple(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));

Select IsSimple(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))'));

Select IsSimple(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111))))));

Select IsSimple(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

Select IsSimple(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select IsSimple(GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

Select IsSimple(GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0),MULTIPOINT(point(0, 0), point(1, 1)), LINESTRING(point(0, 0),point(10, 10)),MULTILINESTRING(LINESTRING(point(1, 2), point(1, 3))),POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2))),MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(1, 0), Point(1, 1),Point(0, 0))))))));


--echo #WKB data, little-endian format
Select IsSimple(GeometryFromWKB(0x0107000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440));

Select IsSimple(GeometryFromWKB(0x0107000000030000000101000000000000000000144000000000000014400102000000020000000000000000000000000000000000000000000000000024400000000000002440010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000000));

Select IsSimple(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40));


--echo #WKB data, big-endian format
Select IsSimple(GeometryFromWKB(0x0000000007000000020000000001000000000000000000000000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000));

Select IsSimple(GeometryFromWKB(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000));

Select IsSimple(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000));


--error ER_GIS_INVALID_DATA
Select IsSimple(GeomCollFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()), POLYGON(()))'));

--error ER_GIS_INVALID_DATA
Select IsSimple(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON((), ()))'));

--ERROR 1064
Select IsSimple(GeometryFromWKB(AsWKB(GeometryCollection(Point(), Point(),LineString(Point(), Point())))));
--error ER_GIS_INVALID_DATA
Select IsSimple(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((),()),(())), MULTILINESTRING((),()), MULTIPOINT())'));

--error ER_GIS_INVALID_DATA
Select IsSimple(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()))'));

--ERROR 1064
Select IsSimple(GeometryFromWKB(AsWKB(GeometryCollection(POINT(), MULTIPOLYGON(Polygon(LineString(Point(), Point(), Point(), Point()))), MULTILINESTRING(LINESTRING(point(), point(), point()), LINESTRING(point(), point(), point())), LINESTRING(point(),point())))));

--error ER_GIS_INVALID_DATA
Select IsSimple(GeomCollFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

--error ER_GIS_INVALID_DATA
Select IsSimple(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ), (ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select IsSimple(GeometryFromWKB(AsWKB(GeometryCollection(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'),LineString(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'))))));

--error ER_GIS_INVALID_DATA
Select IsSimple(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((@ $),(% -&)),((1, 2))), MULTILINESTRING((@ $, % -&, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

--error ER_GIS_INVALID_DATA
Select IsSimple(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(@ $), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select IsSimple(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));


Select IsSimple(GeomCollFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0)), POLYGON((5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select IsSimple(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0), (5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select IsSimple(GeometryFromWKB(AsWKB(GeometryCollection(Point(5, 5), Point(0.0009, 0.0),LineString(Point(4.999999, 4.999999), Point(9.99999, 9.99999))))));

Select IsSimple(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0),(4 4, 6 4, 6 8, 4 8, 4 4)),((4 4, 6 4, 6 8, 4 8, 4 4))), MULTILINESTRING((0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999),(0 10, 5 5, 10 10)), MULTIPOINT(0 10, 5 5, 10 10))'));

Select IsSimple(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select IsSimple(GeometryFromWKB(AsWKB(GeometryCollection(POINT(5, 5), MULTIPOLYGON(Polygon(LineString(Point(0.0009, 0.0), Point(4.999999, 4.999999), Point(15, 0), Point(0.0009, 0)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

--enable_warnings

--echo #Invalid WKB data
--error ER_GIS_DATA_WRONG_ENDIANESS
Select IsSimple(0x0104000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select IsSimple(0x0000000006000000020000000001BFF0000000000000C130F44700000000000000000300000001000000050000000000000000000000000000000000000000000000004014000000000000401400000000000040140000000000004014000000000000000000000000000000000000000000000000000000000000);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select IsSimple(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000);

############################################################################################
# Checking the IsEmpty for the geometrycollection class                                    #
############################################################################################

--echo #Checking the IsEmpty for the geometrycollection class 
select fid,IsEmpty(g) from gis_geometrycollection where g is not NULL;
select count(IsEmpty(g)) FROM gis_geometrycollection;


--echo #Checking the geometry types of some random Geometry Collections.
--disable_Warnings
Select IsEmpty(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));

Select IsEmpty(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))'));

Select IsEmpty(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111))))));

Select IsEmpty(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

Select IsEmpty(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select IsEmpty(GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

Select IsEmpty(GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0),MULTIPOINT(point(0, 0), point(1, 1)), LINESTRING(point(0, 0),point(10, 10)),MULTILINESTRING(LINESTRING(point(1, 2), point(1, 3))),POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2))),MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(1, 0), Point(1, 1),Point(0, 0))))))));



--echo #WKB data, little-endian format
Select IsEmpty(GeometryFromWKB(0x0107000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440));

Select IsEmpty(GeometryFromWKB(0x0107000000030000000101000000000000000000144000000000000014400102000000020000000000000000000000000000000000000000000000000024400000000000002440010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000000));

Select IsEmpty(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40));


--echo #WKB data, big-endian format
Select IsEmpty(GeometryFromWKB(0x0000000007000000020000000001000000000000000000000000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000));

Select IsEmpty(GeometryFromWKB(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000));

Select IsEmpty(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000));


--error ER_GIS_INVALID_DATA
Select IsEmpty(GeomCollFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()), POLYGON(()))'));

--error ER_GIS_INVALID_DATA
Select IsEmpty(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON((), ()))'));

--ERROR 1064
Select IsEmpty(GeometryFromWKB(AsWKB(GeometryCollection(Point(), Point(),LineString(Point(), Point())))));
--error ER_GIS_INVALID_DATA
Select IsEmpty(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((),()),(())), MULTILINESTRING((),()), MULTIPOINT())'));

--error ER_GIS_INVALID_DATA
Select IsEmpty(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()))'));

--ERROR 1064
Select IsEmpty(GeometryFromWKB(AsWKB(GeometryCollection(POINT(), MULTIPOLYGON(Polygon(LineString(Point(), Point(), Point(), Point()))), MULTILINESTRING(LINESTRING(point(), point(), point()), LINESTRING(point(), point(), point())), LINESTRING(point(),point())))));

--error ER_GIS_INVALID_DATA
Select IsEmpty(GeomCollFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

--error ER_GIS_INVALID_DATA
Select IsEmpty(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ), (ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select IsEmpty(GeometryFromWKB(AsWKB(GeometryCollection(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'),LineString(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'))))));

--error ER_GIS_INVALID_DATA
Select IsEmpty(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((@ $),(% -&)),((1, 2))), MULTILINESTRING((@ $, % -&, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

--error ER_GIS_INVALID_DATA
Select IsEmpty(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(@ $), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select IsEmpty(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));


Select IsEmpty(GeomCollFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0)), POLYGON((5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select IsEmpty(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0), (5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select IsEmpty(GeometryFromWKB(AsWKB(GeometryCollection(Point(5, 5), Point(0.0009, 0.0),LineString(Point(4.999999, 4.999999), Point(9.99999, 9.99999))))));

Select IsEmpty(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0),(4 4, 6 4, 6 8, 4 8, 4 4)),((4 4, 6 4, 6 8, 4 8, 4 4))), MULTILINESTRING((0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999),(0 10, 5 5, 10 10)), MULTIPOINT(0 10, 5 5, 10 10))'));

Select IsEmpty(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select IsEmpty(GeometryFromWKB(AsWKB(GeometryCollection(POINT(5, 5), MULTIPOLYGON(Polygon(LineString(Point(0.0009, 0.0), Point(4.999999, 4.999999), Point(15, 0), Point(0.0009, 0)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

--enable_warnings

--echo #Invalid WKB data
--error ER_GIS_DATA_WRONG_ENDIANESS
Select IsEmpty(0x0104000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select IsEmpty(0x0000000006000000020000000001BFF0000000000000C130F44700000000000000000300000001000000050000000000000000000000000000000000000000000000004014000000000000401400000000000040140000000000004014000000000000000000000000000000000000000000000000000000000000);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select IsEmpty(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000);

############################################################################################
# Checking the Area for the geometrycollection class                                    #
############################################################################################

--echo #Checking the Area for the geometrycollection class 
--error ER_GIS_INVALID_DATA
select fid,Area(g) from gis_geometrycollection where g is not NULL;
--error ER_GIS_INVALID_DATA
select count(Area(g)) FROM gis_geometrycollection;


--echo #Checking the geometry types of some random Geometry Collections.
--disable_Warnings
Select Area(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));

Select Area(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))'));

Select Area(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111))))));
--error ER_GIS_INVALID_DATA
Select Area(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

Select Area(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select Area(GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

Select Area(GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0),MULTIPOINT(point(0, 0), point(1, 1)), LINESTRING(point(0, 0),point(10, 10)),MULTILINESTRING(LINESTRING(point(1, 2), point(1, 3))),POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2))),MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(1, 0), Point(1, 1),Point(0, 0))))))));


--echo #WKB data, little-endian format
Select Area(GeometryFromWKB(0x0107000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440));

Select Area(GeometryFromWKB(0x0107000000030000000101000000000000000000144000000000000014400102000000020000000000000000000000000000000000000000000000000024400000000000002440010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000000));

Select Area(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40));


--echo #WKB data, big-endian format
Select Area(GeometryFromWKB(0x0000000007000000020000000001000000000000000000000000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000));

Select Area(GeometryFromWKB(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000));

Select Area(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000));


--error ER_GIS_INVALID_DATA
Select Area(GeomCollFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()), POLYGON(()))'));

--error ER_GIS_INVALID_DATA
Select Area(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON((), ()))'));

--ERROR 1064
Select Area(GeometryFromWKB(AsWKB(GeometryCollection(Point(), Point(),LineString(Point(), Point())))));
--error ER_GIS_INVALID_DATA
Select Area(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((),()),(())), MULTILINESTRING((),()), MULTIPOINT())'));

--error ER_GIS_INVALID_DATA
Select Area(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()))'));

--ERROR 1064
Select Area(GeometryFromWKB(AsWKB(GeometryCollection(POINT(), MULTIPOLYGON(Polygon(LineString(Point(), Point(), Point(), Point()))), MULTILINESTRING(LINESTRING(point(), point(), point()), LINESTRING(point(), point(), point())), LINESTRING(point(),point())))));

--error ER_GIS_INVALID_DATA
Select Area(GeomCollFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

--error ER_GIS_INVALID_DATA
Select Area(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ), (ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select Area(GeometryFromWKB(AsWKB(GeometryCollection(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'),LineString(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'))))));

--error ER_GIS_INVALID_DATA
Select Area(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((@ $),(% -&)),((1, 2))), MULTILINESTRING((@ $, % -&, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

--error ER_GIS_INVALID_DATA
Select Area(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(@ $), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

--error ER_GIS_INVALID_DATA
Select Area(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));


Select Area(GeomCollFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0)), POLYGON((5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select Area(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0), (5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select Area(GeometryFromWKB(AsWKB(GeometryCollection(Point(5, 5), Point(0.0009, 0.0),LineString(Point(4.999999, 4.999999), Point(9.99999, 9.99999))))));

Select Area(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0),(4 4, 6 4, 6 8, 4 8, 4 4)),((4 4, 6 4, 6 8, 4 8, 4 4))), MULTILINESTRING((0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999),(0 10, 5 5, 10 10)), MULTIPOINT(0 10, 5 5, 10 10))'));

Select Area(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select Area(GeometryFromWKB(AsWKB(GeometryCollection(POINT(5, 5), MULTIPOLYGON(Polygon(LineString(Point(0.0009, 0.0), Point(4.999999, 4.999999), Point(15, 0), Point(0.0009, 0)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

--enable_warnings

--echo #Invalid WKB data
--error ER_GIS_DATA_WRONG_ENDIANESS
Select Area(0x0104000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select Area(0x0000000006000000020000000001BFF0000000000000C130F44700000000000000000300000001000000050000000000000000000000000000000000000000000000004014000000000000401400000000000040140000000000004014000000000000000000000000000000000000000000000000000000000000);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select Area(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000);

############################################################################################
# Checking the NumGeometries for the geometrycollection class                             #
############################################################################################

--echo #Checking the NumGeometries for the geometrycollection class 
select fid, NumGeometries(g) from gis_geometrycollection where g is not NULL;
select count( NumGeometries(g)) FROM gis_geometrycollection;


--echo #Checking the geometry types of some random Geometry Collections.
--disable_Warnings
Select NumGeometries(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));

Select NumGeometries(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))'));

Select NumGeometries(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111))))));

Select NumGeometries(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

Select NumGeometries(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select NumGeometries(GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

Select NumGeometries(GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0),MULTIPOINT(point(0, 0), point(1, 1)), LINESTRING(point(0, 0),point(10, 10)),MULTILINESTRING(LINESTRING(point(1, 2), point(1, 3))),POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2))),MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(1, 0), Point(1, 1),Point(0, 0))))))));


--echo #WKB data, little-endian format
Select NumGeometries(GeometryFromWKB(0x0107000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440));

Select NumGeometries(GeometryFromWKB(0x0107000000030000000101000000000000000000144000000000000014400102000000020000000000000000000000000000000000000000000000000024400000000000002440010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000000));

Select NumGeometries(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40));


--echo #WKB data, big-endian format
Select NumGeometries(GeometryFromWKB(0x0000000007000000020000000001000000000000000000000000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000));

Select NumGeometries(GeometryFromWKB(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000));

Select NumGeometries(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000));


--error ER_GIS_INVALID_DATA
Select NumGeometries(GeomCollFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()), POLYGON(()))'));

--error ER_GIS_INVALID_DATA
Select NumGeometries(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON((), ()))'));

--ERROR 1064
Select NumGeometries(GeometryFromWKB(AsWKB(GeometryCollection(Point(), Point(),LineString(Point(), Point())))));
--error ER_GIS_INVALID_DATA
Select NumGeometries(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((),()),(())), MULTILINESTRING((),()), MULTIPOINT())'));

--error ER_GIS_INVALID_DATA
Select NumGeometries(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()))'));

--ERROR 1064
Select NumGeometries(GeometryFromWKB(AsWKB(GeometryCollection(POINT(), MULTIPOLYGON(Polygon(LineString(Point(), Point(), Point(), Point()))), MULTILINESTRING(LINESTRING(point(), point(), point()), LINESTRING(point(), point(), point())), LINESTRING(point(),point())))));

--error ER_GIS_INVALID_DATA
Select NumGeometries(GeomCollFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

--error ER_GIS_INVALID_DATA
Select NumGeometries(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ), (ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select NumGeometries(GeometryFromWKB(AsWKB(GeometryCollection(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'),LineString(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'))))));

--error ER_GIS_INVALID_DATA
Select NumGeometries(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((@ $),(% -&)),((1, 2))), MULTILINESTRING((@ $, % -&, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'));

--error ER_GIS_INVALID_DATA
Select NumGeometries(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(@ $), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'));

Select NumGeometries(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));


Select NumGeometries(GeomCollFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0)), POLYGON((5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select NumGeometries(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0), (5 -1, 11 5, 5 11, -1 5, 5 -1)))'));

Select NumGeometries(GeometryFromWKB(AsWKB(GeometryCollection(Point(5, 5), Point(0.0009, 0.0),LineString(Point(4.999999, 4.999999), Point(9.99999, 9.99999))))));

Select NumGeometries(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0),(4 4, 6 4, 6 8, 4 8, 4 4)),((4 4, 6 4, 6 8, 4 8, 4 4))), MULTILINESTRING((0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999),(0 10, 5 5, 10 10)), MULTIPOINT(0 10, 5 5, 10 10))'));

Select NumGeometries(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'));

Select NumGeometries(GeometryFromWKB(AsWKB(GeometryCollection(POINT(5, 5), MULTIPOLYGON(Polygon(LineString(Point(0.0009, 0.0), Point(4.999999, 4.999999), Point(15, 0), Point(0.0009, 0)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))));

--enable_warnings

--echo #Invalid WKB data
--error ER_GIS_DATA_WRONG_ENDIANESS
Select NumGeometries(0x0104000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select NumGeometries(0x0000000006000000020000000001BFF0000000000000C130F44700000000000000000300000001000000050000000000000000000000000000000000000000000000004014000000000000401400000000000040140000000000004014000000000000000000000000000000000000000000000000000000000000);
--error ER_GIS_DATA_WRONG_ENDIANESS
Select NumGeometries(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000);

############################################################################################
# Checking the GeometryN for the geometrycollection class                                #
############################################################################################

--echo #Checking the GeometryN for the geometrycollection class 
select fid, AsText(GeometryN(g,0)) from gis_geometrycollection where g is not NULL;
select fid, AsText(GeometryN(g,1)) from gis_geometrycollection where g is not NULL;
select fid, AsText(GeometryN(g,2)) from gis_geometrycollection where g is not NULL;
select fid, AsText(GeometryN(g,3)) from gis_geometrycollection where g is not NULL;
select count(GeometryN(g,1)) FROM gis_geometrycollection;


--echo #Checking the geometry types of some random Geometry Collections.
--disable_Warnings
Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'),1));

Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'),3));

Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'),4));

Select AsText(GeometryN(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(10 10), LINESTRING(10 10,20 20), POLYGON((10 10, 20 10, 20 20, 10 20, 10 10), (14 14, 16 14, 16 16, 14 16, 14 14)))'),3));

Select AsText(GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(Point(99.99, -0.1111), Point(200.99, 11111),LineString(Point(99.99, -0.1111), Point(200.99, 11111))))),3));

Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-100 -100, -100 0, 0 0, 0 -100, -100 -100),(-50 -50)),((-100 -100, -100 0, 0 0, 0 -100, -100 -100))), MULTILINESTRING((0 0, -50 -50, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'),1));

Select AsText(GeometryN(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'),2));

Select AsText(GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(POINT(15, 5), MULTIPOLYGON(Polygon(LineString(Point(10, 10), Point(20, 10), Point(15, 0), Point(10, 10)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))),2));

Select AsText(GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(POINT(0, 0),MULTIPOINT(point(0, 0), point(1, 1)), LINESTRING(point(0, 0),point(10, 10)),MULTILINESTRING(LINESTRING(point(1, 2), point(1, 3))),POLYGON(LineString(Point(10, 20), Point(1, 1), Point(2, 2))),MULTIPOLYGON(Polygon(LineString(Point(0, 0), Point(1, 0), Point(1, 1),Point(0, 0))))))),5));


--echo #WKB data, little-endian format
Select AsText(GeometryN(GeometryFromWKB(0x0107000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440),2));

Select AsText(GeometryN(GeometryFromWKB(0x0107000000030000000101000000000000000000144000000000000014400102000000020000000000000000000000000000000000000000000000000024400000000000002440010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000000),3));

Select AsText(GeometryN(GeometryFromWKB(0x0107000000030000000101000000000000000000244000000000000024400102000000020000000000000000002440000000000000244000000000000034400000000000003440010300000002000000050000000000000000002440000000000000244000000000000034400000000000002440000000000000344000000000000034400000000000002440000000000000344000000000000024400000000000002440050000000000000000002C400000000000002C4000000000000030400000000000002C40000000000000304000000000000030400000000000002C4000000000000030400000000000002C400000000000002C40),4));


--echo #WKB data, big-endian format
Select AsText(GeometryN(GeometryFromWKB(0x0000000007000000020000000001000000000000000000000000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000),2));

Select AsText(GeometryN(GeometryFromWKB(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000),4));

Select AsText(GeometryN(GeometryFromWKB(0x00000000070000000600000000010000000000000000000000000000000000000000060000000200000000030000000200000005403C000000000000403A000000000000403C00000000000000000000000000004055000000000000000000000000000040550000000000004045000000000000403C000000000000403A00000000000000000005404A0000000000004032000000000000405080000000000040370000000000004052400000000000402200000000000040480000000000004018000000000000404A000000000000403200000000000000000000030000000100000005404D80000000000040320000000000004050C0000000000040320000000000004050C00000000000402A000000000000404D800000000000402A000000000000404D80000000000040320000000000000000000005000000020000000002000000034024000000000000404800000000000040240000000000004035000000000000402400000000000000000000000000000000000002000000034030000000000000000000000000000040300000000000004037000000000000403000000000000040480000000000000000000002000000020000000000000000000000000000000040240000000000004024000000000000000000000400000004000000000100000000000000000000000000000000000000000140240000000000004024000000000000000000000140240000000000004034000000000000000000000140340000000000004034000000000000000000000300000002000000050000000000000000000000000000000040490000000000000000000000000000404900000000000040490000000000000000000000000000404900000000000000000000000000000000000000000000000000054024000000000000402400000000000040340000000000004024000000000000403400000000000040340000000000004024000000000000403400000000000040240000000000004024000000000000),6));


--error ER_GIS_INVALID_DATA
Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()), POLYGON(()))'),2));

--error ER_GIS_INVALID_DATA
Select AsText(GeometryN(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON((), ()))'),1));

--ERROR 1064
Select AsText(GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(Point(), Point(),LineString(Point(), Point())))),1));
--error ER_GIS_INVALID_DATA
Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((),()),(())), MULTILINESTRING((),()), MULTIPOINT())'),1));

--error ER_GIS_INVALID_DATA
Select AsText(GeometryN(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(), LINESTRING(), POLYGON(()))'),1));

--ERROR 1064
Select AsText(GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(POINT(), MULTIPOLYGON(Polygon(LineString(Point(), Point(), Point(), Point()))), MULTILINESTRING(LINESTRING(point(), point(), point()), LINESTRING(point(), point(), point())), LINESTRING(point(),point())))),1));

--error ER_GIS_INVALID_DATA
Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'),1));

--error ER_GIS_INVALID_DATA
Select AsText(GeometryN(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(ëô ôÑ), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ), (ëô ôÑ, ëô ôÑ, ëô ôÑ)))'),1));

Select AsText(GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'),LineString(Point('ëô', 'ôÑ'), Point('ëô', 'ôÑ'))))),1));

--error ER_GIS_INVALID_DATA
Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((@ $),(% -&)),((1, 2))), MULTILINESTRING((@ $, % -&, -100 -100),(-100 0, -50 -50, 0 -100)), MULTIPOINT(-50 -50))'),4));

--error ER_GIS_INVALID_DATA
Select AsText(GeometryN(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(@ $), LINESTRING(ëô ôÑ, ëô ôÑ, ëô ôÑ), POLYGON((ëô ôÑ, ëô ôÑ, ëô ôÑ)))'),5));

Select AsText( GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))),4));

Select AsText( GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(POINT('@', '$'), MULTIPOLYGON(Polygon(LineString(Point('ëô', 'ôÑ'), Point('%', '-&'), Point(15, 0), Point(0, 0)))), MULTILINESTRING(LINESTRING(point('0.1', 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))),99999999999));


Select AsText( GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0)), POLYGON((5 -1, 11 5, 5 11, -1 5, 5 -1)))'),2));

Select AsText( GeometryN(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999), POLYGON((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0), (5 -1, 11 5, 5 11, -1 5, 5 -1)))'),2));

Select AsText(GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(Point(5, 5), Point(0.0009, 0.0),LineString(Point(4.999999, 4.999999), Point(9.99999, 9.99999))))),2));

Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(MULTIPOLYGON(((-0 -0, 10.00001 0, 10.00001 10.00001, 0.000009 9.999999, 0 0),(4 4, 6 4, 6 8, 4 8, 4 4)),((4 4, 6 4, 6 8, 4 8, 4 4))), MULTILINESTRING((0.0009 0.0, 4.999999 4.999999, 9.99999 9.99999),(0 10, 5 5, 10 10)), MULTIPOINT(0 10, 5 5, 10 10))'),3));

Select AsText(GeometryN(GeometryCollectionFromText('GEOMETRYCOLLECTION(POINT(5 5), LINESTRING(0 0, 10 10), POLYGON((0 0, 10 0, 10 10, 0 10, 0 0)))'),1));

Select AsText(GeometryN(GeometryFromWKB(AsWKB(GeometryCollection(POINT(5, 5), MULTIPOLYGON(Polygon(LineString(Point(0.0009, 0.0), Point(4.999999, 4.999999), Point(15, 0), Point(0.0009, 0)))), MULTILINESTRING(LINESTRING(point(10, 48), point(10, 21), point(10, 0)), LINESTRING(point(16, 0), point(16, 23), point(16, 48))), LINESTRING(point(0, 0),point(10, 10))))),2));

--enable_warnings

--echo #Invalid WKB data
--error ER_GIS_DATA_WRONG_ENDIANESS
Select AsText(GeometryN(0x0104000000020000000101000000000000000000000000000000000000000102000000020000000000000000000000000000000000000000000000000024400000000000002440,2));
--error ER_GIS_DATA_WRONG_ENDIANESS
Select AsText(GeometryN(0x0000000006000000020000000001BFF0000000000000C130F44700000000000000000300000001000000050000000000000000000000000000000000000000000000004014000000000000401400000000000040140000000000004014000000000000000000000000000000000000000000000000000000000000,5));
--error ER_GIS_DATA_WRONG_ENDIANESS
Select AsText(GeometryN(0x000000000700000003000000000140240000000000004024000000000000000000000200000002402400000000000040240000000000004034000000000000403400000000000000000000030000000200000005402400000000000040240000000000004034000000000000402400000000000040340000000000004034000000000000402400000000000040340000000000004024000000000000402400000000000000000005402C000000000000402C0000000000004030000000000000402C00000000000040300000000000004030000000000000402C0000000000004030000000000000402C000000000000402C000000000000,1));

############################################################################################
# Checking the procedure with the Attributes of the Geometry collection class              #
############################################################################################

--echo #Checking the procedure with the Attributes of the Geometry collection class
--disable_warnings
delimiter |;
--echo #create procedure to check Attributes
CREATE PROCEDURE poly_attri()
BEGIN
Select GeometryType(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));
Select SRID(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));
Select Dimension(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));
Select AsText(Envelope(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))')));
Select IsSimple(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));
Select IsEmpty(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));
Select Area(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));
Select NumGeometries(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'));
Select AsText(GeometryN(GeomCollFromText('GEOMETRYCOLLECTION(POINT(0 0), LINESTRING(0 0,10 10), POLYGON((10 10, 0 10, 0 0, 10 0, 10 10)), POLYGON((10 10, 10 0, 0 0, 0 10, 10 10)))'),1));
END |
delimiter ;|

--echo #call the proc
CALL poly_attri;









--enable_warnings

--echo #Dropping the created procedures.
drop procedure poly_attri;

############################################################################################
# Checking the Geometry collection properties from within the cursor                       #
############################################################################################

--echo #Checking the Geometry collection properties from within the cursor 
CREATE TABLE gis_geometrycollection_cursor select * from gis_geometrycollection limit 1;

delimiter |;
CREATE PROCEDURE geom_attri_cursor()
BEGIN
  DECLARE v GEOMETRYCOLLECTION;
  DECLARE c CURSOR FOR Select g from gis_geometrycollection_cursor;
  OPEN c;
  FETCH c INTO v;
  Select AsText(v);
  Select GeometryType(v);
  Select SRID(v);
  Select Dimension(v);
  Select AsText(Envelope(v));
  Select IsSimple(v);
  Select IsEmpty(v);
  Select Area(v);
  CLOSE c;
END|
delimiter ;|

--echo #Calling the cursor
CALL geom_attri_cursor();

--echo #Dropping the created cursor
drop procedure geom_attri_cursor;
drop table gis_geometrycollection_cursor;

--echo #Final Cleanup
--disable_warnings
DROP TABLE IF EXISTS gis_geometrycollection;
--enable_warnings
